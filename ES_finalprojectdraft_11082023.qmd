---
title: "My Final Project"
subtitle: "BMIN503/EPID600 Final Project"
author: "Elaine Sang"
format: html
editor: visual
number-sections: true
embed-resources: true
---

------------------------------------------------------------------------

## Overview {#sec-overview}

This is an exploratory study on whether a random forest model using age, insurance status, gender, and race/ethnicity, and BMI can predict the likelihood hospital readmission and morality among patients with a primary diagnosis of pulmonary hypertension. The purpose of this study is to become familiarized with methods associated with random forest modeling. I anticipate creating an ROC curve and using 10-fold cross validation for this study.

## Introduction {#sec-introduction}

Pulmonary hypertension, as defined by the National Heart, Lung, and Blood Institute, is a chronic disease characterized by elevated blood pressure within the lungs. This causes increase strain within the heart as it needs to work harder to pump blood to the lungs. There are many different types of pulmonary hypertension, including chronic thromboembolic pulmonary hypertension, pulmonary arterial hypertension, pulmonary hypertension from left-sided heart disease, and primary pulmonary hypertension. This chronic condition does not have a cure, is progressive, and directly contributes to debilitating symptoms such as shortness of breath and chest pain. However, the pulmonary hypertension patient population is seriously understudied, leading to knowledge gaps that may impact care.

For this final project, I want to conduct an exploratory study to examine whether a random forest model using patient level factors, such as age, insurance status, gender, and race/ethnicity, and BMI can predict the likelihood of 30-day and 60-day hospital readmission and 30-day and 60-day morality among patients with a primary diagnosis of pulmonary hypertension. Findings may inform future policies, individualized care plans, and clinical practice guidelines to improve care among patients with pulmonary hypertension.

## Methods {#sec-methods}

I have acquired the Medical Information Mart for Intensive Care IV (MIMIC-IV) database after using the data user agreement with PhysioNet, which is organized by MIT. It contains deidentified information from patients admitted to the intensive care units (ICU) of Beth Israel Deaconess Medical Center from 2008 - 2019.

```{r}
#| label: load-packages

library(dplyr)
```

```{r}
#Find ICD-9 and ICD-10 codes for pulmonary hypertension. First get the database containing ICD codes and corresponding diagnoses

ICD_code_diagnosis <- read.csv("/Users/esang/Desktop/Upenn courses/fall 2023/BMIN 503/final project/mimic-iv-2.2/hosp/d_icd_diagnoses.csv.gz",header = TRUE, sep = ",")

# Assuming your data frame is named 'your_data_frame'
# Replace 'your_data_frame' with the actual name of your data frame

# Create a logical index for rows containing the desired patterns
keywords <- c("pulmonary hypertension", "pulmonary arterial hypertension")
ICD_PH <- grepl(paste(pattern, collapse = "|"), 
ICD_code_diagnosis$long_title, ignore.case = TRUE)

filtered_data <- 
ICD_code_diagnosis[index,]


ICD_PH <- ICD_code_diagnosis |>
  filter(grepl("pulmonary. *hypertension", long_title, ignore.case = TRUE))

View(ICD_PH)

#Now create database of patients who have a primary diagnosis of pulmonary hypertension
all_patient_diagnoses <- read.csv("/Users/esang/Desktop/Upenn courses/fall 2023/BMIN 503/final project/mimic-iv-2.2/hosp/diagnoses_icd.csv.gz",header = TRUE, sep = ",")

#everyone who had has a diagnoses of pulmonary hypertension, regardless of whether it is primary or not primary. 
PH_sample <- all_patient_diagnoses %>%
  filter(
    (icd_version == 9 & icd_code == '4160') |
      (icd_version == 10 & icd_code %in% c('I270', 'I272', 'I2720', 'I2722', 'I2723', 'I2724', 'I2729', 'I2721'))
  )

primary_PH_sample <- PH_sample %>%
  filter(seq_num == 1)


```

## Results {#sec-results}

Describe your results and include relevant tables, plots, and code/comments used to obtain them. You may refer to the @sec-methods as needed. End with a brief conclusion of your findings related to the question you set out to address. You can include references if you'd like, but this is not required.

## Conclusion

This the conclusion. The @sec-results can be invoked if you'd like.
