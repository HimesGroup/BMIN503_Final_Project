---
title: "Spatiotemporal Patterns of Influenza Activity in the United States"
subtitle: "BMIN503/EPID600 Final Project"
author: "Grace Li"
format: html
editor: visual
embed-resources: true
---

------------------------------------------------------------------------

Use this template to complete your project throughout the course. Your Final Project presentation will be based on the contents of this document. Replace the title/name above and text below with your own, but keep the headers. Feel free to change the theme and other display settings, although this is not required.

### Overview

*Give a brief a description of your project and its goal(s), what data you are using to complete it, and what two faculty/staff in different fields you have spoken to about your project with a brief summary of what you learned from each person. Include a link to your final project GitHub repository.*

Season influenza viruses continues to be a major global burden. There are around a billion cases annually and up to 650,000 people die of influenza. Influenza activity patterns vary geographically and temporally, so we want to examine the spatiotemporal patterns of influenza activity in the United States and determine if variations in influenza activities across states or regions are associated with accumulation of mutations in circulating virus strains. I will be using influenza-like illness (ILI) activity data published by the Centers for Disease Control and Prevention (CDC) and viral sequences from the Global Initiative on Sharing All Influenza Data (GIDSAID) to answer these questions. Understanding patterns of seasonal influenza activity can help guide early influenza surveillance and inform influenza prevention and control programs. Materials for this project can be found in [this GitHub repository](https://github.com/graceshli/BMIN503_Final_Project).

### Introduction

*Describe the problem addressed, its significance, and some background to motivate the problem.*

*Explain why your problem is interdisciplinary, what fields can contribute to its understanding, and incorporate background related to what you learned from meeting with faculty/staff.*

Influenza has a large seasonal burden in the United States: up to 35 million people are infected annually causing between 12,000 and 56,000 deaths. In the U.S., flu season typically starts on the 40th week of the year (1st week of October), but influenza activity including time of onset, duration, and number of peaks varies greatly across the states. We speculate that characteristics of circulating virus strains contribute to the spatiotemporal patterns observed in influenza activity.

The CDC routinely publishes weekly reports of influenza surveillance data providing a national picture of influenza virus activities in the U.S. More specifically, the U.S. Outpatient Influenza-like Illness Surveillance Network (ILINet) reports the number of patients with symptoms of ILI. ILI is a good indicator of influenza activities allowing estimation of influenza activities across different states and regions. Efforts by public health laboratories to sequence influenza genomes have also allowed researchers to study sequences of influenza viruses using databases like GISAID. By linking regional epidemiologic data to circulating influenza sequencing data, we hope to identify genetic characteristics associated with influenza activities in the U.S. An understanding of the spatial and temporal spread of influenza can help inform public health decisions in influenza prevention and control.

### Methods

Describe the data used and general methodological approach. Subsequently, incorporate full R code necessary to retrieve and clean data, and perform analysis. Be sure to include a description of code so that others (including your future self) can understand what you are doing and why.

```{r}
#| label: load-packages
#| include: false

library(tidyverse)
library(dplyr)
library(cowplot)
library(leaflet)
```

```{r}
#| label: ili_case

state_ili_case <- read_csv("StateDatabySeason.csv")

state_ili_case <- state_ili_case |>
        select(-c(URL, WEBSITE)) |>
        rename(state = STATENAME, 
               level = `ACTIVITY LEVEL`, 
               label = `ACTIVITY LEVEL LABEL`,
               weekend = WEEKEND,
               week = WEEK,
               season = SEASON) |> 
        mutate(level = as.numeric(gsub("Level ", "", level))) |>
        mutate(ordered_week = (week - 40) %% 52 + 1) 

states <- data.frame(state = datasets::state.name, division = datasets::state.division) 

state_ili_case <- inner_join(state_ili_case, state_division, by = "state")

pa_ili_case <- state_ili_case |>
        filter(state == "Pennsylvania")

pa_ili_case |> filter(season == "2018-19") |>
        ggplot(aes(x = ordered_week, y = level)) +
        geom_point() +
        geom_line() +
        scale_x_continuous(breaks = 1:52, labels = c(40:52, 1:39)) +
        labs(x = "Week", y = "ILI Activity Level", title = "2018-19 ILI Activity") +
        theme_classic()
        
```

### Results

Describe your results and include relevant tables, plots, and code/comments used to obtain them. End with a brief conclusion of your findings related to the question you set out to address. You can include references if you'd like, but this is not required.
