---
title: "BMIN503/EPID600 Project"
author: "Xingyue Zhu"
output: 
  html_document:
    theme: paper 
    highlight: tango
---
```{r set-options, echo=FALSE, cache=FALSE}
options(width = 400)
```  
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

required packages
```{r}
library(data.table)
library(dplyr)
library(corrr)
library(ggplot2)
library(RColorBrewer)
```

### Overview

```{r}
#Read in data
Math <- fread(input = "https://raw.githubusercontent.com/clairezhu0421/BMIN503_Final_Project/master/raw_data/student-mat.csv", sep = ",", header = T)
Portuguese <- fread("https://raw.githubusercontent.com/clairezhu0421/BMIN503_Final_Project/master/raw_data/student-por.csv", sep = ",", header = T)

#Raw data overview
library(GGally)
ggpairs(Math, mapping = aes(col = ), columns = c(), axisLabels = "show")

```


### Introduction 
Despite laws banning teenagers from drinking alcohol until they are adults, teenage binge drinking is still a common problem. This study was designed to see if drinking alcohol among teenagers had any adverse effects on them.

The data were obtained in a survey of students math and Portuguese language courses in secondary school. It contains a lot of interesting social, gender and study information about students, especially their alcohol consumption. I would like to use it for finding out the most important factor that related to the students final grade. To see if teen binge drinking has a negative impact on their learning performance. And create a prediction model to predict the student's final score. This problem is related to education, statistic and computer science. Solving it needs a clear and thorough understanding about semantics, regression model as well as solid programming skills. I will apply multiple regression models that we learned in this course and rigorous data pre-processing, multifaceted validation to get a persuasive result.
```{r}
#Pre-processing
#Convert binary character variables into numeric variables (1 or 0)
Math <- Math %>% 
  mutate(school = factor(school, levels = c("GP", "MS"), labels = c(1, 0))) %>%
  mutate(sex = factor(sex, levels = c("M", "F"), labels = c(1, 0))) %>%
  mutate(address = factor(address, levels = c("U", "R"), labels = c(1, 0))) %>%
  mutate(famsize = factor(famsize, levels = c("GT3", "LE3"), labels = c(1, 0))) %>%
  mutate(Pstatus = factor(Pstatus, levels = c("T", "A"), labels = c(1, 0))) %>%
  mutate(schoolsup = factor(schoolsup, levels = c("yes", "no"), labels = c(1, 0))) %>%
  mutate(famsup = factor(famsup, levels = c("yes", "no"), labels = c(1, 0))) %>%
  mutate(paid = factor(paid, levels = c("yes", "no"), labels = c(1, 0))) %>%
  mutate(activities = factor(activities, levels = c("yes", "no"), labels = c(1, 0))) %>%
  mutate(nursery = factor(nursery, levels = c("yes", "no"), labels = c(1, 0))) %>%
  mutate(higher = factor(higher, levels = c("yes", "no"), labels = c(1, 0))) %>%
  mutate(internet = factor(internet, levels = c("yes", "no"), labels = c(1, 0))) %>%
  mutate(romantic = factor(romantic, levels = c("yes", "no"), labels = c(1, 0)))

#Apply one-hot coding convert category variables in to numeric variables
Math.clean <- cbind(select_if(Math, is.numeric), select_if(Math, is.factor)) %>%
  cbind(as.data.frame(model.matrix(~Mjob-1, Math))) %>%
  cbind(as.data.frame(model.matrix(~Fjob-1, Math))) %>%
  cbind(as.data.frame(model.matrix(~reason-1, Math))) %>%
  cbind(as.data.frame(model.matrix(~guardian-1, Math)))
  
```


### Methods
```{r}
#bi-variate correlation test
x <- Math.clean %>% correlate() %>% focus(G3)

x %>% 
  mutate(rowname = factor(rowname, levels = rowname[order(mpg)])) %>%  # Order by correlation strength
  ggplot(aes(x = rowname, y = mpg)) +
    geom_bar(stat = "identity") +
    ylab("Correlation with mpg") +
    xlab("Variable")


```





### Results

