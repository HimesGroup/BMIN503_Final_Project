---
title: "BMIN503/EPID600 Project Template"
author: "Your Name"
output: 
  html_document:
    toc: false 
    depth: 3 
    theme: paper 
    highlight: tango
---
```{r echo=FALSE, cache=FALSE}
options(width = 400)
graphics.off()
#Load libraries
library(Hmisc)
library(dplyr)
library(lattice)
library(survival)
library(Formula)
library(ggplot2)
library(tibble)
library(table1)
library(tableone)
library(knitr)
library(kableExtra)
options(knitr.table.format = "html")
```  
***
Use this template to complete your project throughout the course. Your Final Project presentation in class will be based on the contents of this document. Replace the title/name and text below with your own, but keep the headers.

### Overview
In this section, give a brief a description of your project and its goal, what data you are using to complete it, and what three faculty/staff in different fields you have spoken to about your project with a brief summary of what you learned from each person. Include a link to your final project GitHub repository.

Final Project on Github: [https://github.com/Dokotela/BMIN503_Final_Project](https://github.com/Dokotela/BMIN503_Final_Project)


### Introduction 
+In the first paragraph, describe the problem addressed, its significance, and some background to motivate the problem.
It is well-known that obesity is a problem in our society. This is not just true for adults, but also for children. It is estimated that 18.5% of chldren 2-19 years old were overweight as of 2016^1^. The rate of overweight is over 30%^2^. Hispanics and Non-Hispanic blacks had a higher rate of obesity than Non-Hispanic whites, and those in a lower socio-economic class. The outcomes of this are many, varied and can be severe, including a myriad of health problems along with a wide-range of socio-emotional consequences. Pediatricians are typically not familiar with the best ways to counsel and educate families about nutrition and exercise, and typically have enough time to do so. One possible solution is telehealth interventions. There have already been a few studies demonstrating improvement in adolescent physical activity or increase in fruit and vegetable consumption through telehealth interventions^3,4^.

+In the second paragraph, explain why your problem is interdisciplinary, what fields can contribute to its understanding, and incorporate background related to what you learned from meeting with faculty/staff.
In order for these interventions to be effective, multiple different groups will need to be involved. Patients typically see their primary pediatrician as responsible for their health information, so it would be reasonable to base such an intervention out of an outpatient clinic. However, as above, pediatricians don't generally have the expertise or time to do such counseling. One could involve nutritionists, behavi



### Methods
In the first paragraph, describe the data used and general methodological approach. Subsequently, incorporate full R code necessary to retrieve and clean data, and perform analysis. Be sure to include a description of code so that others (including your future self) can understand what you are doing and why. 

```{r}
#Get the data

#Read Data
data=read.csv('ChronicConditionSpec_DATA_2019-10-02_1538.csv')

#Load Functions for grouping data
source('functions.r')

#Set factors
source('factors.r')

#Set Levels
source('levels.r')

#remove '.factor' from names
data <- data[c(1, 473, 3, 474:478, 9:10, 479:483, 16, 484, 18, 485:487, 22, 488, 24, 489:491, 28, 492, 30, 493:504, 43, 505:510, 50, 511:536, 77, 537:560, 102, 561:588, 131, 589:606, 150, 607:684, 229, 685:715, 261, 716:765, 312, 766:789, 337, 790:821, 370, 822:899, 449, 900:917, 468, 918:919, 471, 920)]
names(data) <- gsub(".factor", "", names(data), fixed = TRUE)

#Name all columns
source('labels.r')

#collect the 4 columns on language preference into 2
data <- add_column(data, "Patient's Language" = NA, .before = "eng")
data$`Patient's Language` <- case_when(
  data$eng == 1 ~ "English",
  data$esp == 1 ~ "Spanish",
  TRUE ~ NA_character_
)
data <- add_column(data, "Parent's Language" = NA, .before = "eng")
data$`Parent's Language` <- case_when(
  data$eng2 == 1 ~ "English",
  data$esp2 == 1 ~ "Spanish",
  TRUE ~ NA_character_
)
data[6:9] <- NULL

#make some better column names
colnames(data)[colnames(data)=="not_part_ethnicity"] <- "ethnicity"
colnames(data)[colnames(data)=="not_part_asthma"] <- "asthma?"
colnames(data)[colnames(data)=="not_part_gender"] <- "gender"
colnames(data)[colnames(data)=="not_part_obese"] <- "obese?"

#remove test patient
data <- data[-c(12, 13, 14, 15, 16, 17),]

#summarize grade levels
data <- data %>% mutate(dem_grade = factor(dem_grade, levels =c("00","0","1","2","3","4","5","6","7","8","9","10","11","12","13"), labels=c("<= 5th Grade", "<= 5th Grade", "<= 5th Grade", "<= 5th Grade", "<= 5th Grade", "<= 5th Grade", "<= 5th Grade", "6-8th grade", "6-8th grade", "6-8th grade", "9-12th grade", "9-12th grade", "9-12th grade", "9-12th grade", "Other")))

#remove unused levels
data <- droplevels(data)
```

```{r}
#make dataframe for anyone completing at least 1 fu
participants <- subset(data, data$redcap_id %in% data$redcap_id[which(data$redcap_event_name=="fu_visit_1_arm_1")])

#make dataframe from above of just the first visit (to evaluate demographics)
participantsFirst <- subset(participants, participants$redcap_event_name=="initial_visit_arm_1")
participantsFirst <- demographics(participantsFirst)

#make dataframe for those that completed a final visit
complete <- subset(data, data$redcap_id %in% data$redcap_id[which(data$redcap_event_name=="final_visit_arm_1")])

#make dataframe from above of just the first visit (to evaluate demographics)
completeFirst <- subset(complete, complete$redcap_event_name=="initial_visit_arm_1")
completeFirst <- demographics(completeFirst)
completeFirst$ethnicity <- droplevels(completeFirst$ethnicity)
```

```{r}
firsttable <- table1(~ ethnicity + `obese?` + `asthma?` + dem_gender, data=completeFirst)
secondtable <-table1(~ dem_grade + dem_language_pref + dem_language_home, data=completeFirst)
thirdtable <- table1(~ dem_parent_sex + dem_parent_ethnicity + dem_parent_language_pref, data=completeFirst)
```


```{r}
firsttable
kable(firsttable)
kable(firsttable) %>%
  kable_styling(bootstrap_options = c("striped"))
```

### Results
Describe your results and include relevant tables, plots, and code/comments used to obtain them. End with a brief conclusion of your findings related to the question you set out to address. You can include references if you'd like, but this is not required.
