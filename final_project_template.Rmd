---
title: "BMIN503/EPID600 Project Template"
author: "Sally Qian"
output: 
  html_document:
    theme: paper 
    highlight: tango
---
```{r set-options, echo=FALSE, cache=FALSE}
options(width = 400)
```  
***
Use this template to complete your project throughout the course. Your Final Project presentation will be based on the contents of this document. Replace the title/name above and text below with your own, but keep the headers.


### Introduction 

Obesity is described as an adverse effect on human health caused by accumulated excess body fat. As one of the major health problems in US, obesity enhances the risk of various severe diseases such as coronary artery disease, high blood pressure, and type 2 diabetes. According to reported data from Centers for Disease Control and Prevention (CDC), the prevalence of obesity increased from 30.5% to 42.4% in the past two decades. Also, the huge medical cost made obesity become a more common and serious disease. Researchers and physicians are always looking for a more effective method to alleviate the problem of obesity. In addition, obesity affects some groups more than others and multiple factors including ethnicity, gender and economic status would have impact on individualsâ€™ vulnerability to obesity. Therefore, this study aims to explore how effective the moderate behavioral weight loss program (intervention group) in overweight and obese adults from the general population, compared with the low-intensity version of the program (control condition). Multiple variables, including clinical site, gender, ethnicity and so on, were recorded and statistically analyzed to determine their impacts on the effectiveness of the moderate behavioral weight loss program.

### Methods
Step 1. I am going to look up the census data to investigate the obesity rate national wide to show how severe the obesity affect people. (KEEP WORKING...)

Step 2. Determine the effectiveness of moderate and low intensity program on patients with obesity by applying multiple statistical analysis. 

```{r}
library(DescTools)
library(readxl)
library(MASS)
library(olsrr)

# Load data
WgtLoss_data <- read_excel("E:/Dropbox/School/Fall 2021/BMIN 503/Final Project/WeightLossData.xlsx")

# 2. Data Description---------------------------------------------
### Find how many data entry are complete (exclude rows with NA)
is_complete <- !is.na(WgtLoss_data$month) & !is.na(WgtLoss_data$wgt_final)
num_complete_data <- sum(is_complete)
print(sprintf("Number of complete data = %d", num_complete_data))
clean_WL_data <- WgtLoss_data[complete.cases(WgtLoss_data),]

# 2.1 Distribution and quantile-quantile (Q-Q) plot of change in body weight 
### Control group 
ctrl_WL_data <- clean_WL_data[(clean_WL_data$tx == 0),]
ctrl_wgt_loss <- (ctrl_WL_data$wgt_final - ctrl_WL_data$wgt_base)
hist(ctrl_wgt_loss, 
     main = "Distribution of change in body Weight (control)",
     xlab = "Change in body Weight (kg)",
     freq = FALSE,
     breaks = seq(-20, 20, 2))
lines(
  x = density(x = ctrl_wgt_loss),
  col = "red"
)

legend(
  "topleft",
  legend = c(paste("Mean =", round(mean(ctrl_wgt_loss), 2)),
             paste("Standard Deviation =", round(sd(ctrl_wgt_loss), 2))),
  cex = 1, bty = "n"
)


# Intervention group
int_WL_data <- clean_WL_data[(clean_WL_data$tx == 1), ]
int_wgt_loss <- (int_WL_data$wgt_final - int_WL_data$wgt_base)
hist(int_wgt_loss, 
     main = "Distribution of change in body Weight (intervention)",
     xlab = "Change in body Weight (kg)",
     freq = FALSE,
     breaks = seq(-25, 15, 2))
lines(
  x = density(x = int_wgt_loss),
  col = "red"
)
legend(
  "topleft",
  legend = c(paste("Mean =", round(mean(int_wgt_loss), 2)),
             paste("Standard Deviation =", round(sd(int_wgt_loss), 2))),
  cex = 1, bty = "n"
)


```


```


### Results
Describe your results and include relevant tables, plots, and code/comments used to obtain them. End with a brief conclusion of your findings related to the question you set out to address. You can include references if you'd like, but this is not required.
