---
title: "BMIN503/EPID600 Project Template"
author: Kira Nightingale
output: 
  html_document:
    theme: paper 
    highlight: tango
---
```{r set-options, echo=FALSE, cache=FALSE}
options(width = 400)
```  
***
Use this template to complete your project throughout the course. Your Final Project presentation will be based on the contents of this document. Replace the title/name above and text below with your own, but keep the headers.

### Overview
Give a brief a description of your project and its goal(s), what data you are using to complete it, and what three faculty/staff in different fields you have spoken to about your project with a brief summary of what you learned from each person. Include a link to your final project GitHub repository.


### Introduction 
Describe the problem addressed, its significance, and some background to motivate the problem.

Explain why your problem is interdisciplinary, what fields can contribute to its understanding, and incorporate background related to what you learned from meeting with faculty/staff.


### Methods
Describe the data used and general methodological approach. Subsequently, incorporate full R code necessary to retrieve and clean data, and perform analysis. Be sure to include a description of code so that others (including your future self) can understand what you are doing and why. 
```{r}

#Loading libraries
library(SASxport)
library(plyr)
library(dplyr)
library(ggplot2)

#Loading data - 2015-2016 and 2017-2018
demog15 <- read.xport("C:/Users/nighki01/Box Sync/Course Materials/2021 Fall_Biomedical Informatics/BMIN503_Final_Project/Data/15-16.DEMO_I.XPT")
ohq15 <- read.xport("C:/Users/nighki01/Box Sync/Course Materials/2021 Fall_Biomedical Informatics/BMIN503_Final_Project/Data/15-16.OHQ_I.XPT")
exam15 <- read.xport("C:/Users/nighki01/Box Sync/Course Materials/2021 Fall_Biomedical Informatics/BMIN503_Final_Project/Data/15-16.OHXDEN_I.XPT")
foodsd115 <- read.xport("C:/Users/nighki01/Box Sync/Course Materials/2021 Fall_Biomedical Informatics/BMIN503_Final_Project/Data/15-16.DR1IFF_I.XPT")
nutritiond115 <- read.xport("C:/Users/nighki01/Box Sync/Course Materials/2021 Fall_Biomedical Informatics/BMIN503_Final_Project/Data/15-16.DR1TOT_I.XPT")

demog17 <- read.xport("C:/Users/nighki01/Box Sync/Course Materials/2021 Fall_Biomedical Informatics/BMIN503_Final_Project/Data/17-18.DEMO_J.XPT")
ohq17 <- read.xport("C:/Users/nighki01/Box Sync/Course Materials/2021 Fall_Biomedical Informatics/BMIN503_Final_Project/Data/17-18.OHQ_J.XPT")
exam17 <- read.xport("C:/Users/nighki01/Box Sync/Course Materials/2021 Fall_Biomedical Informatics/BMIN503_Final_Project/Data/17-18.OHXDEN_J.XPT")
foodsd117 <- read.xport("C:/Users/nighki01/Box Sync/Course Materials/2021 Fall_Biomedical Informatics/BMIN503_Final_Project/Data/17-18.DR1IFF_J.XPT")
nutritiond117 <- read.xport("C:/Users/nighki01/Box Sync/Course Materials/2021 Fall_Biomedical Informatics/BMIN503_Final_Project/Data/17-18.DR1TOT_J.XPT")

#Combining instruments across years
demog <- full_join(demog15, demog17)
ohq <- full_join(ohq15, ohq17)
exam <- full_join(exam15, exam17) #This one won't join - why??
foodsd1 <- full_join(foodsd115, foodsd117)
nutritutiond1 <- full_join(nutritiond115, nutritiond117)

#Cleaning demographic data - creating age groups, renaming variables, removing unneeded variables
demog <- demog %>%
  select(SEQN, RIAGENDR, RIDAGEYR, RIDRETH1, RIDRETH3, DMDEDUC2, DMDEDUC3, DMDMARTL, WTINT2YR, WTMEC2YR, INDHHIN2, INDFMPIR) %>%
  mutate(age.grp = ifelse(RIDAGEYR %in% 10:19, "10-19",
                    ifelse(RIDAGEYR %in% 20:29, "20-29",
                           ifelse(RIDAGEYR %in% 30:39, "30-39",
                                  ifelse(RIDAGEYR %in% 40:49, "40-49",
                                         ifelse(RIDAGEYR %in% 50:59, "50-59",
                                                ifelse(RIDAGEYR %in% 60:69, "60-69",
                                                       ifelse(RIDAGEYR %in% 70:79, "70-79",
                                                              ifelse(RIDAGEYR >79, "80+", "<10"))))))))) %>%
  rename(gender = RIAGENDR, race = RIDRETH1, race2 = RIDRETH3, child.edu = DMDEDUC2, adult.edu = DMDEDUC3, marital = DMDMARTL, weight = WTINT2YR, weight2 = WTMEC2YR, income = INDHHIN2, poverty = INDFMPIR)
  

#Oral exam DMFT score calculation
exam <- exam %>%
  mutate(OHX02CTC=factor(OHX02CTC, levels = c("A", "D", "M", "Q", "S", "U", "X", "Y", "E", "F", "J", "K", "P", "R", "T", "Z"), labels = c(0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1)))

#Merging data into a single data frame
data <-  join_all(list(demog15, exam15, foodsd115, nutritiond115, ohq15, demog17, exam17, foodsd117, nutritiond117, ohq17), by = "SEQN", type = "full")

#Descriptive graphs
ggplot(data = demog, aes(age.grp)) +
  geom_bar()

```


### Results
Describe your results and include relevant tables, plots, and code/comments used to obtain them. End with a brief conclusion of your findings related to the question you set out to address. You can include references if you'd like, but this is not required.
