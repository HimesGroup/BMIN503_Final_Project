---
title: "BMIN503/EPID600 Project Template"
author: "Alison Pouch"
output: 
  html_document:
    toc: false 
    depth: 3 
    theme: paper 
    highlight: tango
---
```{r set-options, echo=FALSE, cache=FALSE}
options(width = 400)
```  
***
Use this template to complete your project throughout the course. Your Final Project presentation in class will be based on the contents of this document. Replace the title/name and text below with your own, but leave the headers.

### Overview
In this section, give a brief a description of your project and its goal, what data you are using to complete it, and what three faculty/staff in different fields you have spoken to about your project with a brief summary of what you learned from each person. Include a link to your final project GitHub repository.

The goal of this project is to evaluate whether features of placenta morphology during the first trimester of pregnancy can be used to predict whether a baby is "small for gestational age (SGA)", meaning that they are born within the 10th percentile of fetal birth weight.


### Introduction 
In the first paragraph, describe the problem addressed, its significance, and some background to motivate the problem.

In the second paragraph, explain why your problem is interdisciplinary, what fields can contribute to its understanding, and incorporate background related to what you learned from meeting with faculty/staff.


### Methods
In the first paragraph, describe the data used and general methodological approach. Subsequently, incorporate full R code necessary to retrieve and clean data, and perform analysis. Be sure to include a description of code so that others (including your future self) can understand what you are doing and why. 

First, the read the data.

Variable Name | Description
--------------|------------
model_id      | model ID number
study_id      | study ID number
race          | race (7,44,1,2,3)
wtscrn        | 
height        | maternal height (in)
sbpscrn       |
crl           | crown rump length (mm)
pappamom      | 
gadel         | 
fetal_sex     | fetal sex (0 = ?, 1 = ?)
birthwt       | fetal birthweight (g)
maternal_age_US1  | maternal age at first ultrasound exam (years)
gest_age_US1      | gestational age at first ultrasound exam (days)
sga_5th       | 
sga_10th      |

``` {r eval=TRUE}
library(readxl)
library(tidyverse)
setwd("/Users/alison/BMIN503_placenta")

# Read in the entire clinical sheet
df.clinical=read_xlsx("/Users/alison/Desktop/BMIN_503/final_project/placenta_subject_data.xlsx") 

# Select variables wanted
df.clinical.some <- df.clinical %>%
    select(model_id = "Model number", 
           study_id = "Study ID", 
           race = "RACE", 
           wtscrn = "WTSCRN (kg)", 
           height = "HT (in)", 
           sbpscrn = "SBPSCRN", 
           crl = "CRL (mm)", 
           pappamom = "PAPPAMOM", 
           gadel = "GADEL", 
           fetal_sex = "FETSEX1", 
           birthwt = "BIRTHWT (g)", 
           maternal_age_US1 = "Maternal Age at US1", 
           gest_age_US1 = "GA US1",
           sga_5th = "SGA<5th%",
           sga_10th = "SGA<10th%") 

# Convert some columns to numeric
variables.numeric <- c("race","wtscrn","height","sbpscrn","crl","pappamom","gadel","fetal_sex","birthwt","maternal_age_US1","gest_age_US1","sga_5th","sga_10th")
df.clinical.some[,names(df.clinical.some) %in% variables.numeric] <- sapply(lapply(df.clinical.some[,names(df.clinical.some) %in% variables.numeric],as.character),as.numeric)

# Make some variables factors
df.clinical.some <- df.clinical.some %>%
    mutate(race = factor(race, levels=c(1,2,3), labels=c("white","black","asian"))) %>%
    mutate(fetal_sex = factor(fetal_sex, levels=c(0,1), labels=c("male","female"))) %>%
    mutate(sga_5th = factor(sga_5th, levels=c(0,1), labels=c("no","yes"))) %>%
    mutate(sga_10th = factor(sga_10th, levels=c(0,1), labels=c("no","yes"))) 

```

Here we perform the exploratory data analysis.

``` {r eval=TRUE}
library(GGally)
library(ggplot2)
library(cowplot)

# Maternal characteristics relative to sga_10th
g1 <- ggplot(data=df.clinical.some, aes(x=race, fill=sga_10th)) +
        geom_bar(position="stack")
g2 <- ggplot(data=df.clinical.some, aes(x=sga_10th,y=sbpscrn)) +
        geom_boxplot()
g3 <- ggplot(data=df.clinical.some, aes(x=sga_10th,y=crl)) +
        geom_boxplot()
g4 <- ggplot(data=df.clinical.some, aes(x=sga_10th,y=height)) +
        geom_boxplot()
g5 <- ggplot(data=df.clinical.some, aes(x=sga_10th,y=wtscrn)) +
        geom_boxplot()

plot_grid(g1, g2, g3, g4, g5, labels="AUTO")

# fetal characteristics relative to sga_10th
f1 <- ggplot(data=df.clinical.some, aes(x=race, fill=sga_10th)) +
        geom_bar(position="stack")
f2 <- ggplot(data=df.clinical.some, aes(x=fetal_sex, fill=sga_10th)) +
        geom_bar(position="stack")
f3 <- ggplot(data=df.clinical.some, aes(x=sga_10th,y=maternal_age_US1)) +
        geom_boxplot()
f4 <- ggplot(data=df.clinical.some, aes(x=sga_10th,y=height)) +
        geom_boxplot()
f5 <- ggplot(data=df.clinical.some, aes(x=sga_10th,y=wtscrn)) +
        geom_boxplot()
f6 <- ggplot(data=df.clinical.some, aes(x=sga_10th,y=gadel)) +
        geom_boxplot()

plot_grid(f1, f2, f3, f4, f5, f6, labels="AUTO")

g6 <- ggplot(data=df.clinical.some, aes(x=sga_10th,y=gadel)) +
        geom_boxplot()

```

### Results
Describe your results and include relevant tables, plots, and code/comments used to obtain them. End with a brief conclusion of your findings related to the question you set out to address. You can include references if you'd like, but this is not required.
