---
title: "Heart Rate Monitors"
author: "Avantika Diwadkar"
output: 
  html_document:
    toc: false 
    depth: 3 
    theme: paper 
    highlight: tango
---
```{r set-options, echo=FALSE, cache=FALSE}
options(width = 400)
```  

### Overview
The main focus of this project is to investigate the use of commercial wearables as possible patient monitoring devices by testing the precision of heart rate measurement by a wrist worn heart rate monitor (FitBit) against a portable ECG-based heart rate computer (Bitalino). The project will involve a statistical model to test the accuracy of the FitBit band.


### Introduction 
Wearable devices are being studied and explored for use as diagnostic monitors replacing the current complicated and expensive medical devices. Heart rate variation can be used for stress response detection due to behavioural, bacterial or other abnormalities. Now-a-days, wrist monitors like FitBit, Apple and Samsung are popular in the market. These devices use photoplethysmography which detects blood racing through the veins by optical sensors. Majority of the limited literature review proves that the bands are mostly accurate in heart rate measurement with few abnormalities at high bpm. 
    The problem addressed in this project covers the field of diagnostics, biomedical devices and data analysis. The project layout consists of device set up and measurement of heart rate at different physiological conditions. The main barrier is the extraction of data from the two devices. The data extracted has to be filtered and converted so that both variables are in same units. The statistical model will involve Wilcoxon signed-rank test or one sample t-test depending upon the distribution. The measurements will be quantified by Bland-Altman plots and correlation coefficients will be calculated. I met Mr. Jeff Pennington from Children's Hospital of Philadelphia who is guiding me in this project and providing the devices for use. CHOP is interested in exploring the use of wearable devices and this project may aid them in determining the accuracy of these devices. 


### Methods
My project includes the set up, data acquisition, data extraction, signal processing, mathematical conversions and analysis of data from devices - FitBit and Bitalino ECG device. I am using R package fitbitscraper to extract data from the fitbit cloud and the rhd5 package to read the data from Bitalino device. For the Bitalino, I am using the Opensignals software and a Python Bitalino API to take measurements using the device. The data is related to heart rate measured in beats per minute and milliVolts for FitBit and Bitalino respectively. The main problem I am currently addressing is the convertion of the mV data from Bitalino to beats per minute. I am converting the ECG values obtained from bitalino into appropriate values by the formula: ECGV = (ECGB * Vcc / 2^n - Vcc / 2) / GECG 

Where: 
ECGV – ECG value in Volts (V)
ECGmV - ECG value in miliVolts (mV)
ECGB – ECG value obtained from BITalino
Vcc – Operating Voltage (V) 
n – number of bits (bit) 
GECG – ECG Sensor Gain 

Values: 
Vcc = 3.3 (V)
GECG = 1100 
n= 10 (for Channel 3)

I am visualizing the plots of the heart rate acquired from both the devices. The main method used to analyze the data points acquired from both the devices is Bland-Altman plots using the R package BlandAltmanLeh and a correlation to check for accuracy and conclude if FitBit can be used as a patient monitoring device.


### Results
My results will include screenshots of the softwares used, the devices used, plots of heart rate data measured, plots of ECG signal processing plots, Bland-Altman plots and a correlation data result. I will explain the results of my hypothesis and also include information on further analysis and scope of this project at a larger scale.
