---
title: "BMIN503/EPID600 Final Project"
author: "Sarah Cohen"
output: 
html_document:
theme: paper 
highlight: tango
---
  ```{r set-options, echo=FALSE, cache=FALSE}
options(width = 400)
```  
***

### Overview
My final project will be using the CHDB Southeastern Pennsylvania Household Health Survey to investigate the relationship between mental health outcomes and social predictors in adults living in the greater Philadelphia area. Another layer of this project will examine whether the strength of these relationships differs between geographical areas such as county.

Faculty Mentors:
-Dr. Kate Rendle, Department of Family Medicine and Community Health
-Dr. John Holmes, Department of Epidemiology and Biostatistics
-Dr. David Mandell, Penn Center for Mental Health

GitHub repository link: https://github.com/sarahrc121/BMIN503_Final_Project


### Introduction 
The problem I am focusing on is how the quality and perception of belonging in oneâ€™s neighborhood can be reflected in the occurrence of a mental disorder diagnosis and whether mental health treatment is sought out. There have been many publications showing increased odds of certain mental disorders in children living in neighborhoods with poor conditions (both physically and socially), but not much research has focused on this relationship in adults (Butler et al., 2012; Dahal et al., 2018; Kemp et al., 2016; Plybon & Kliewer, 2001; Reuben et al., 2020). A similar analysis was conducted in Philadelphia, investigating the relationship between neighborhood characteristics and serious mental illness diagnosis in adults (Byrne et al., 2013). However, my analysis will be using the entire Philadelphia population as a whole, whereas the Bynre et al. analysis only included adults already being treated for serious mental illness. My project will also offer another layer to analysis with breakdowns of relationships by geographic regions.

This project will involve a few fields of knowledge to understand the problems, create appropriate analyses and visuals, and interpret the results and relationships. Firstly, this problem presents as an issue in the field of mental health; we can better understand what factors may predict poorer mental health outcomes. It is also a major issue for public health because the analysis will be at the population level. Revealing what neighborhoods are showing the greatest risks of neighborhood estrangement and associated mental health outcomes will educate public health entities in the Philadelphia area, and could even be a jumping-off point for geographically-targeted mental health interventions. Lastly, data science is an important field that will contribute to this project. The use of data tools to analyze, manipulate, and map these variables will be able to describe and visualize the relationships I aim to explore.


### Methods

# INSTALL NECESSARY PACKAGES
``` {r}
library(dplyr)
library(haven)
library(ggplot2)
library(leaflet)
library(tidyverse)
library(zipcodeR)
library(maps)
library(sf)
library(car)
library(pROC)
```

# DATA READ-IN AND CLEAN
``` {r}

# READ IN DATA, CURRENTLY IN STATA DATA FORMAT
chdb_raw <- read_dta('H:\\MBMI\\Data Science\\Final Project\\HHS18AR.dta')

head(chdb_raw)

# CHANGE 'NA'S TO ZEROES
chdb_raw[is.na(chdb_raw)] <- 0

# CHANGE CATEGORICAL VARIABLES TO CHARACTER
chdb_raw[,c('MENTAL3A','tretmnta', 'NEIGHBOR_FA', 'IMPROVE_FA', 'BELONG_FA','TRUST_FA','HAVEPARK2_FA','SOCCAP_2CAT_FA','SOCCAP_3CAT_FA', 'SEX01', 'RESPAGE_4CAT', 'RSPGRAD2', 'respempl', 'RESPRACE_4CAT', 'NPOV100', 'SEXIDENT2')] <- lapply(chdb_raw[,c('MENTAL3A','tretmnta', 'NEIGHBOR_FA', 'IMPROVE_FA', 'BELONG_FA','TRUST_FA','HAVEPARK2_FA','SOCCAP_2CAT_FA','SOCCAP_3CAT_FA', 'SEX01', 'RESPAGE_4CAT', 'RSPGRAD2', 'respempl', 'RESPRACE_4CAT', 'NPOV100', 'SEXIDENT2')], as.character)

# SELECT ONLY RESPONSES FROM FORM A RESPONDENTS (FORM A INCLUDED SOCIAL DETERMINANT QUESTIONS)
chdb <- chdb_raw %>%
              filter(form==1)

# DAT1 WILL BE THE DATASET I WILL WORK WITH THAT HAS VARIABLES OF INTEREST
dat1 <- data.frame()

# RE-LABEL LEVELS OF ORIGINAL CATEGORICAL VARIABLES SO EASIER TO MAKE SENSE OF
for (i in 1:nrow(chdb)) {
  if(chdb[i, 'MENTAL3A']=="1") {
    dat1[i, 'mh_dx'] <- 1
  }
  else  {
  dat1[i, 'mh_dx'] <- 0
  }
}


for (i in 1:nrow(chdb)) {
  if(chdb[i, 'tretmnta']=="1") {
    dat1[i, 'mh_trt'] <- 1
  } 
  else  {
  dat1[i, 'mh_trt'] <- 0
  }
}



for (i in 1:nrow(chdb)) {
  if(chdb[i, 'NEIGHBOR_FA']=="1") {
    dat1[i, 'neigh_help'] <- "Always"
  } else if(chdb[i, 'NEIGHBOR_FA']=="2") {
  dat1[i, 'neigh_help'] <- "Often"
  }
  else if(chdb[i, 'NEIGHBOR_FA']=="3") {
  dat1[i, 'neigh_help'] <- "Sometimes"
  }
  else if(chdb[i, 'NEIGHBOR_FA']=="4") {
  dat1[i, 'neigh_help'] <- "Rarely"
  }
  else if(chdb[i, 'NEIGHBOR_FA']=="5") {
  dat1[i, 'neigh_help'] <- "Never"
  }
  else  {
  dat1[i, 'neigh_help'] <- "Unknown"
  }
}


for (i in 1:nrow(chdb)) {
  if(chdb[i, 'IMPROVE_FA']=="1") {
    dat1[i, 'neigh_toget'] <- "Yes"
  } else if(chdb[i, 'IMPROVE_FA']=="2") {
  dat1[i, 'neigh_toget'] <- "No"
  }
  else  {
  dat1[i, 'neigh_toget'] <- "Unknown"
  }
}


for (i in 1:nrow(chdb)) {
  if(chdb[i, 'BELONG_FA']=="1") {
    dat1[i, 'belong'] <- "Strongly Agree"
  } else if(chdb[i, 'BELONG_FA']=="2") {
  dat1[i, 'belong'] <- "Agree"
  }
  else if(chdb[i, 'BELONG_FA']=="3") {
  dat1[i, 'belong'] <- "Disagree"
  }
  else if(chdb[i, 'BELONG_FA']=="4") {
  dat1[i, 'belong'] <- "Strongly Disagree"
  }
  else  {
  dat1[i, 'belong'] <- "Unknown"
  }
}


for (i in 1:nrow(chdb)) {
  if(chdb[i, 'TRUST_FA']=="1") {
    dat1[i, 'trust'] <- "Strongly Agree"
  } else if(chdb[i, 'TRUST_FA']=="2") {
  dat1[i, 'trust'] <- "Agree"
  }
  else if(chdb[i, 'TRUST_FA']=="3") {
  dat1[i, 'trust'] <- "Disagree"
  }
  else if(chdb[i, 'TRUST_FA']=="4") {
  dat1[i, 'trust'] <- "Strongly Disagree"
  }
  else  {
  dat1[i, 'trust'] <- "Unknown"
  }
}


for (i in 1:nrow(chdb)) {
  if(chdb[i, 'HAVEPARK2_FA']=="1") {
    dat1[i, 'park'] <- "Yes"
  } else if(chdb[i, 'HAVEPARK2_FA']=="2") {
  dat1[i, 'park'] <- "No, no park"
  }
  else if(chdb[i, 'HAVEPARK2_FA']=="3") {
  dat1[i, 'park'] <- "No, not comfortable"
  }
  else  {
  dat1[i, 'park'] <- "Unknown"
  }
}


for (i in 1:nrow(chdb)) {
  if(chdb[i, 'SOCCAP_2CAT_FA']=="1") {
  dat1[i, 'soc_2cat'] <- "Low"
  } 
  else if(chdb[i, 'SOCCAP_2CAT_FA']=="2") {
  dat1[i, 'soc_2cat'] <- "Medium or High"
  }
  else  {
  dat1[i, 'soc_2cat'] <- "Unknown"
  }
}


for (i in 1:nrow(chdb)) {
  if(chdb[i, 'SOCCAP_3CAT_FA']=="1") {
    dat1[i, 'soc_3cat'] <- "Low"
  } 
  else if(chdb[i, 'SOCCAP_3CAT_FA']=="2") {
  dat1[i, 'soc_3cat'] <- "Medium"
  } 
  else if(chdb[i, 'SOCCAP_3CAT_FA']=="3") {
  dat1[i, 'soc_3cat'] <- "High"
  }
  else  {
  dat1[i, 'soc_3cat'] <- "Unknown"
  }
}


for (i in 1:nrow(chdb)) {
  if(chdb[i, 'SEX01']=="1") {
    dat1[i, 'sex'] <- "Male"
  } 
  else if(chdb[i, 'SEX01']=="2") {
  dat1[i, 'sex'] <- "Female"
  } 
}


for (i in 1:nrow(chdb)) {
  if(chdb[i, 'RESPAGE_4CAT']=="1") {
    dat1[i, 'age'] <- "18-34"
  } 
  else if(chdb[i, 'RESPAGE_4CAT']=="2") {
  dat1[i, 'age'] <- "35-49"
  } 
  else if(chdb[i, 'RESPAGE_4CAT']=="3") {
  dat1[i, 'age'] <- "50-64"
  }
  else if(chdb[i, 'RESPAGE_4CAT']=="4") {
  dat1[i, 'age'] <- "65+"
  }
}


for (i in 1:nrow(chdb)) {
  if(chdb[i, 'RSPGRAD2']=="1") {
    dat1[i, 'edu'] <- "Less than HS"
  } 
  else if(chdb[i, 'RSPGRAD2']=="2") {
  dat1[i, 'edu'] <- "High school grad"
  } 
  else if(chdb[i, 'RSPGRAD2']=="3") {
  dat1[i, 'edu'] <- "Tech/trade/vocational"
  }
  else if(chdb[i, 'RSPGRAD2']=="4") {
  dat1[i, 'edu'] <- "Some college"
  }
  else if(chdb[i, 'RSPGRAD2']=="5") {
  dat1[i, 'edu'] <- "College grad"
  }
  else if(chdb[i, 'RSPGRAD2']=="6") {
  dat1[i, 'edu'] <- "Post-grad"
  }
  else  {
  dat1[i, 'edu'] <- "Unknown"
  }
}


for (i in 1:nrow(chdb)) {
  if(chdb[i, 'respempl']=="1") {
    dat1[i, 'emp'] <- "Full-time"
  } 
  else if(chdb[i, 'respempl']=="2") {
  dat1[i, 'emp'] <- "Part-time"
  } 
  else if(chdb[i, 'respempl']=="3") {
  dat1[i, 'emp'] <- "Unemployed but looking"
  }
  else if(chdb[i, 'respempl']=="4") {
  dat1[i, 'emp'] <- "Unemployed, not looking"
  }
  else if(chdb[i, 'respempl']=="5") {
  dat1[i, 'emp'] <- "Retired"
  }
  else if(chdb[i, 'respempl']=="6") {
  dat1[i, 'emp'] <- "Unable to work/disabled"
  }
  else if(chdb[i, 'respempl']=="7") {
  dat1[i, 'emp'] <- "Homemaker"
  }
  else if(chdb[i, 'respempl']=="8") {
  dat1[i, 'emp'] <- "Student/training"
  }
  else  {
  dat1[i, 'emp'] <- "Unknown"
  }
}


for (i in 1:nrow(chdb)) {
  if(chdb[i, 'RESPRACE_4CAT']=="1") {
    dat1[i, 'race'] <- "White"
  } 
  else if(chdb[i, 'RESPRACE_4CAT']=="2") {
  dat1[i, 'race'] <- "Black"
  } 
  else if(chdb[i, 'RESPRACE_4CAT']=="3") {
  dat1[i, 'race'] <- "Asian"
  }
  else if(chdb[i, 'RESPRACE_4CAT']=="4") {
  dat1[i, 'race'] <- "Other"
  }
}


for (i in 1:nrow(chdb)) {
  if(chdb[i, 'NPOV100']=="1") {
    dat1[i, 'poverty'] <- "Yes"
  } 
  else if(chdb[i, 'NPOV100']=="2") {
  dat1[i, 'poverty'] <- "No"
  } 
}


for (i in 1:nrow(chdb)) {
  if(chdb[i, 'SEXIDENT2']=="1") {
    dat1[i, 'sex_or'] <- "Hetero/straight"
  } 
  else if(chdb[i, 'SEXIDENT2']=="2") {
  dat1[i, 'sex_or'] <- "Gay/lesbian"
  } 
  else if(chdb[i, 'SEXIDENT2']=="3") {
  dat1[i, 'sex_or'] <- "Bisexual"
  }
  else if(chdb[i, 'SEXIDENT2']=="4") {
  dat1[i, 'sex_or'] <- "Other"
  }
  else {
  dat1[i, 'sex_or'] <- "Unknown"  
  }
}

# ADD ZIP CODE TO WORKING DATASET
dat1$zip <- chdb$zipcode

# CHANGE 'UNKNOWN' VALUES TO NA
dat1[dat1=="Unknown"] <- NA

dat1_mh <- dat1 %>%
           filter(mh_dx=="Yes")

```

# EXAMINE VARIABLES OF INTEREST (MENTAL HEALTH AND SOCIAL) WITH BASIC FREQUENCIES AND PLOTS
``` {r}
# EVER DIAGNOSED WITH MENTAL HEALTH CONDITION
dat1 %>%
  group_by(mh_dx) %>%
  summarize(n())

ggplot(data=dat1, aes(x=mh_dx)) +
  geom_bar()

# IF DIAGNOSED WITH MENTAL HEALTH CONDITION, CURRENTLY IN TREATMENT
dat1_mh %>%
  group_by(mh_trt) %>%
  summarize(n())

ggplot(data=dat1_mh, aes(x=mh_trt)) +
  geom_bar()

# NEIGHBORS WILLING TO HELP EACH OTHER
dat1 %>%
  group_by(neigh_help) %>%
  summarize(n())

ggplot(data=dat1, aes(x=neigh_help)) +
  geom_bar()

# NEIGHBORS EVER WORKED TOGETHER
dat1 %>%
  group_by(neigh_toget) %>%
  summarize(n())

ggplot(data=dat1, aes(x=neigh_toget)) +
  geom_bar()

# FEEL I BELONG IN MY NEIGHBORHOOD
dat1 %>%
  group_by(belong) %>%
  summarize(n())

ggplot(data=dat1, aes(x=belong)) +
  geom_bar()

# PEOPLE IN MY NEIGHBORHOOD CAN BE TRUSTED
dat1 %>%
  group_by(trust) %>%
  summarize(n())

ggplot(data=dat1, aes(x=trust)) +
  geom_bar()

# PARK OR OUTDOOR SPACE COMFORTABLE VISITING
dat1 %>%
  group_by(park) %>%
  summarize(n())

ggplot(data=dat1, aes(x=park)) +
  geom_bar()

# SOCIAL CAPITAL SCALE, 2 CATEGORIES (LOW, MEDIUM/HIGH)
dat1 %>%
  group_by(soc_2cat) %>%
  summarize(n())

ggplot(data=dat1, aes(x=soc_2cat)) +
  geom_bar()

# SOCIAL CAPITAL SCALE, 3 CATEGORIES (LOW, MEDIUM, HIGH)
dat1 %>%
  group_by(soc_3cat) %>%
  summarize(n())

ggplot(data=dat1, aes(x=soc_3cat)) +
  geom_bar()


```



# GEOGRAPHICAL DATA EXPLORATION
``` {r}

# GET COORDINATES FOR ZIP CODES IN DATASET
dat1_geocodes <- geocode_zip(dat1$zip)
dat1_geocodes <- rename(dat1_geocodes, zip=zipcode)

dat1 <- merge(dat1, dat1_geocodes, by='zip')
dat1_zip <- dat1 %>%
            filter(!is.na(lat) & !is.na(lng))


# CREATE BASE MAP OF PHILADELPHIA AREA
phl.map <- map("county", "pennsylvania", xlim=c(-77,-74), ylim=c(39,41))

phl.map <- readRDS(gzcon(url("https://raw.githubusercontent.com/HimesGroup/BMIN503/master/DataFiles/philadelphia_tracts_2010.rds")))
phl.geo <- st_geometry(phl_map)

# CREATE SF OBJECT FROM ORIGINAL DATASET TO BE ABLE TO PLOT
dat1.nona.geo <- dat1 %>%
                 filter(!is.na(lat) & !is.na(lng))

phl.shape <- st_crs(4326)

dat1.geo <- st_as_sf(dat1.nona.geo,
                    coords=c("lng", "lat"),
                    crs=phl.shape)


# PLOT EACH RESPONSE ON BASE MAP 
plot(phl.geo)
plot(st_geometry(dat1), col="red", add=TRUE)


ggplot() +
  geom_sf(data=phl.map) +
  geom_sf(data=dat1.geo)

```



# SOCIAL SCALE AND INDIVIDUAL SOCIAL VARIABLES BY MENTAL HEALTH DIAGNOSIS
``` {r}

# SOCIAL CAPITAL SCALE (2 CATEGORIES) BY MENTAL HEALTH DIAGNOSIS
table(dat1$soc_2cat, dat1$mh_dx)
chisq.test(dat1$soc_2cat, dat1$mh_dx)
# p<0.00001**

dat1 %>%
  filter(!is.na(mh_dx), !is.na(soc_2cat)) %>%
  ggplot(aes(x=mh_dx, fill=soc_2cat)) +
  geom_bar()

# SOCIAL CAPITAL SCALE (3 CATEGORIES) BY MENTAL HEALTH DIAGNOSIS
table(dat1$soc_3cat, dat1$mh_dx)
chisq.test(dat1$soc_3cat, dat1$mh_dx)
# p<0.00001**

dat1 %>%
  filter(!is.na(mh_dx), !is.na(soc_3cat)) %>%
  ggplot(aes(x=mh_dx, fill=soc_3cat)) +
  geom_bar()

table(dat1$neigh_help, dat1$mh_dx)
chisq.test(dat1$neigh_help, dat1$mh_dx)
# Neighbors willing to help each other x mental health dx; p=0.001545**

table(dat1$neigh_toget, dat1$mh_dx)
chisq.test(dat1$neigh_toget, dat1$mh_dx)
# Neighbors ever worked together x mental health dx; p=0.06143*

table(dat1$belong, dat1$mh_dx)
chisq.test(dat1$belong, dat1$mh_dx)
# Feeling of belonging in neighborhood x mental health dx; p<0.00001**

table(dat1$trust, dat1$mh_dx)
chisq.test(dat1$trust, dat1$mh_dx)
# People in neighborhood can be trusted x mental health dx; p<0.00001**

table(dat1$park, dat1$mh_dx)
chisq.test(dat1$park, dat1$mh_dx)
# Park comfortable visiting x mental health dx; p=0.006208**

```

> Focus on most significant predictors: social capital scale (3 levels), neighbors willing to help each other, feeling of belonging in neighborhood, people in neighborhood can be trusted, and have a park comfortable visiting

# EVALUATE INDEPENDENT SOCIAL VARIABLES FOR SUITABILITY FOR REGRESSION (MISSINGNESS, VARIABILITY, COLLINEARITY)
``` {r}

# NEIGHBORS WILLING TO HELP
table(dat1$neigh_help, useNA="ifany")
# Varied responses with not too many missing values

chisq.test(dat1$neigh_help, dat1$neigh_toget)
# p<0.0001; highly correlated
chisq.test(dat1$neigh_help, dat1$belong)
# p<0.0001; highly correlated
chisq.test(dat1$neigh_help, dat1$trust)
# p<0.0001; highly correlated
chisq.test(dat1$neigh_help, dat1$park)
# p<0.0001; highly correlated


# NEIGHBORS EVER WORKED TOGETHER
table(dat1$neigh_toget, useNA="ifany")
# Varied responses with not too many missing values

chisq.test(dat1$neigh_toget, dat1$belong)
# p<0.0001; highly correlated
chisq.test(dat1$neigh_toget, dat1$trust)
# p<0.0001; highly correlated
chisq.test(dat1$neigh_toget, dat1$park)
# p<0.0001; highly correlated


# FEELING OF BELONGING IN NEIGHBORHOOD
table(dat1$belong, useNA="ifany")
# Varied responses with not too many missing values

chisq.test(dat1$belong, dat1$trust)
# p<0.0001; highly correlated
chisq.test(dat1$belong, dat1$park)
# p<0.0001; highly correlated


# PEOPLE IN NEIGHBORHOOD CAN BE TRUSTED
table(dat1$trust, useNA="ifany")
# Varied responses with not too many missing values

chisq.test(dat1$trust, dat1$park)
# p<0.0001; highly correlated


# PARK COMFORTABLE VISITING
table(dat1$park, useNA="ifany")
# Varied responses with not too many missing values

```

> Since all of the social determinant variables are highly correlated with each other, they will not be included in the final logistic regression models. The main independent variable will be the social scale with 3 categories (low, medium, and high) that is calculated based on all social determinant responses.

# SOCIAL SCALE AND INDIVIDUAL SOCIAL VARIABLES BY MENTAL HEALTH TREATMENT
``` {r}


table(dat1_mh$soc_2cat, dat1_mh$mh_trt)
chisq.test(dat1_mh$soc_2cat, dat1_mh$mh_trt)
# p=0.6645

dat1_mh %>%
  filter(!is.na(mh_trt), !is.na(soc_2cat)) %>%
  ggplot(aes(x=mh_trt, fill=soc_2cat)) +
  geom_bar()


table(dat1_mh$soc_3cat, dat1_mh$mh_trt)
chisq.test(dat1_mh$soc_3cat, dat1_mh$mh_trt)
# p=0.8656

dat1_mh %>%
  filter(!is.na(mh_trt), !is.na(soc_3cat)) %>%
  ggplot(aes(x=mh_trt, fill=soc_3cat)) +
  geom_bar()




table(dat1_mh$neigh_help, dat1_mh$mh_trt)
chisq.test(dat1_mh$neigh_help, dat1_mh$mh_trt)
# p=0.5604

table(dat1_mh$neigh_toget, dat1_mh$mh_trt)
chisq.test(dat1_mh$neigh_toget, dat1_mh$mh_trt)
# p=0.2028

table(dat1_mh$belong, dat1_mh$mh_trt)
chisq.test(dat1_mh$belong, dat1_mh$mh_trt)
# p=0.6033

table(dat1_mh$trust, dat1_mh$mh_trt)
chisq.test(dat1_mh$trust, dat1_mh$mh_trt)
# p=0.6915

table(dat1_mh$park, dat1_mh$mh_trt)
chisq.test(dat1_mh$park, dat1_mh$mh_trt)
# p=0.6587

```

> It appears that none of the social variables are significantly associated with seeking mental health treatment. Therefore, I will not move forward with this part of the analysis.

# PERFORM LOGISTIC REGRESSION ON OUTCOME OF MENTAL HEALTH DIAGNOSIS VERSUS SOCIAL DETERMINANT VARIABLES, CONTROLLING FOR CERTAIN DEMOGRAPHIC VARIABLES 
``` {r}

# CREATE LOGISTIC REGRESSION MODEL
mh.fit <- glm(mh_dx ~ soc_3cat+sex+age+edu+emp+race+poverty+sex_or, data=dat1, family=binomial())

summary(mh.fit)
exp(coef(mh.fit))

# LOGISTIC REGRESSION PREDICTED OUTCOMES
mh.pred <- predict(mh.fit, dat1, type="response")
head(mh.pred)

# CROSS-VALIDATION
N = nrow(dat1)
K = 10
set.seed(1234)
s = sample(1:K, size = N, replace = T)
pred.outputs.glm <- vector(mode = "numeric", length = N)
obs.outputs <- vector(mode = "numeric", length = N)
offset <- 0
for (i in 1:K) {
    train <- filter(dat1, s != i)
    test <- filter(dat1, s == i)
  obs.outputs[1:length(s[s == i]) + offset] <- test$mh_dx
    
  #GLM train/test
  glm <- glm(mh_dx ~ soc_3cat+sex+age+edu+emp+race+poverty+sex_or, data=train, family=binomial())
  glm.pred.curr <- predict(glm, test, type = "response")
  pred.outputs.glm[1:length(s[s == i]) + offset] <- glm.pred.curr
  
  offset <- offset + length(s[s == i])
}

head(cbind(pred.outputs.glm, obs.outputs))

# ROC CURVE
roc(dat1$mh_dx, mh.pred, ci=TRUE)

plot.roc(dat1$mh_dx, mh.pred, ci=TRUE)
plot.roc(obs.outputs, pred.outputs.glm, col="red", add=TRUE)

glm.roc <- plot.roc(dat1$mh_dx, mh.pred, col="red", lwd=3, grid=TRUE)
plot(ci.thresholds(glm.roc), col="grey")
legend("bottomright", legend=c("Training", "Cross-Validation"), col=c("black", "red"), lwd=2)


```


### Results
Describe your results and include relevant tables, plots, and code/comments used to obtain them. End with a brief conclusion of your findings related to the question you set out to address. You can include references if you'd like, but this is not required.
