---
title: "County-Level Dynamics and Predictors of Drug Overdose Death in the United States (2015-2020)"
subtitle: "BMIN 5030 Final Project"
author: "Chris Miller"
date: "`r Sys.Date()`"
output:
  html_document:
    theme: flatly 
    toc: TRUE
    collapsed: FALSE
    highlight: tango
    fig_height: 12
    fig_width: 12
---

***

# Overview
The association between region-specific prescription opioid prescribing and the rate of opioid overdose death was well documented during the time periods when prescription opioids were the primary cause of overdose deaths. However, the role of regional prescribing practices has been less studied since illicit opioids became the primary causes of opioid overdose deaths. The goal of this project is to characterize the dynamics of opioid overdose deaths in the United States from 2015 to 2020 and to evaluate county-level predictors of opioid overdose including prescription opioid prescribing and health indicators (e.g., depression, obesity, lack of health insurance, smoking, binge drinking, self-reported poor mental health). 

# Introduction 
The opioid overdose epidemic in the United States has transitioned over the past two decades from being primarily driven by misuse and abuse of prescription opioid analgesics in the early 2000s to one driven by heroin in the mid 2010s and by illicit fentanyl and fentanyl analogs after 2016 ([Hedegaard et al, 2020](https://www.cdc.gov/nchs/data/databriefs/db394-H.pdf)). In recognition of the crisis, federal agencies and professional associations modified recommendations and practice guidelines to minimize the use of prescription opioids for acute and chronic pain ([Dowell et al, 2016](https://www.cdc.gov/mmwr/volumes/65/rr/rr6501e1.htm), [Dowell et al, 2022](https://www.cdc.gov/mmwr/volumes/71/rr/rr7103a1.htm)). Since 2010, the morphine milligram equivalents (MMEs) of opioids dispensed per person has declined nationally by more than 40% ([American Medical Association, 2021](https://end-overdose-epidemic.org/wp-content/uploads/2021/09/AMA-2021-Overdose-Epidemic-Report_92021.pdf)). However, there remains substantial regional variation across the country in opioid prescribing and the rate of overdose deaths attributable to commonly prescribed opioids has not declined since its peak in 2010 ([Mattson et al, 2021](https://www.cdc.gov/mmwr/volumes/70/wr/mm7006a4.htm?s_cid=mm7006a4_w)). 

Previous studies have demonstrated that the regional rate of opioid prescribing per capita was highly associated with the regional rate of opioid overdose deaths when prescription opioids were the primary cause of overdose deaths ([Bohnert et al, 2014](https://journals.lww.com/clinicalpain/Fulltext/2014/07000/Trends_and_Regional_Variation_in_Opioid_Overdose.8.aspx); [Madarai et al, 2013](https://www.sciencedirect.com/science/article/abs/pii/S0376871613000185?via%3Dihub)). But with the dramatic increase in heroin- and fentanyl-related overdose deaths, the relationship between regional patterns in prescription opioid prescribing and all-cause opioid overdose death (i.e, due to prescription or illicit opioids) have not continued to be well characterized. This is despite the fact that one of the primary pathways to illicit opioid use continues to be misuse of prescription opioids ([Soffin et al, 2019](https://www.sciencedirect.com/science/article/pii/S0007091218313382)). While there are many paths to the development of an opioid use disorder, many individuals initiate the misuse or abuse of opioids due to psychological factors (e.g., depression, anxiety, social isolation) ([Martins et al, 2011](https://www.cambridge.org/core/journals/psychological-medicine/article/abs/mood-and-anxiety-disorders-and-their-association-with-nonmedical-prescription-opioid-use-and-prescription-opioiduse-disorder-longitudinal-evidence-from-the-national-epidemiologic-study-on-alcohol-and-related-conditions/2B40E54FF1FD3698742D565399B64F20)) and commonly misuse or abuse other substances such as alcohol and marijuana ([Fiellin et al, 2013](https://www.sciencedirect.com/science/article/pii/S1054139X12002315?casa_token=X8lLhiPwALQAAAAA:3ZN_dopZfVmSzq2oZfAk90V4Z0bLGzRYa3NvMUUzjjxNFn7vpeUtCTODoe_Rz-F4D-7Is-fbKd0)). 

The Centers for Disease Control and Prevention (CDC) maintains publicly available databases that report cause-specific opioid overdose death rates by state (Vital Statistics Rapid Release [VSRR]), county-level opioid dispensing rates (IQVIA Xponent), county-level drug overdose mortality rates (National Center for Health Statistics [NCHS]), and county-specific data on several social determinants of health (PLACES). This collection of data sources facilitates an updated evaluation of the relationships between opioid overdose deaths, prescription opioid prescribing, and community-level health issues.

# Methods
Changes in opioid overdose rates by drug (i.e., prescription opioid, heroin, synthetic opioid) from 2015 to 2020 were characterized using [VSRR data](https://data.cdc.gov/NCHS/VSRR-Provisional-Drug-Overdose-Death-Counts/xkb8-kh2a/) on drug overdose deaths. Line plots of the number of individuals who died of an overdose by drug type in the US were generated to provide rationale for the key study questions. 

To evaluate changes in the dynamics of recent opioid prescribing, County-level opioid dispensing tables reported on the [CDC website](https://www.cdc.gov/drugoverdose/rxrate-maps/index.html) were transfered into Excel files by year. These files were merged with county-level geometry data by FIPS code to create choropleth maps by year. 

Data on county-level health indicators were extracted from the [PLACES dataset](https://chronicdata.cdc.gov/500-Cities-Places/PLACES-Local-Data-for-Better-Health-County-Data-20/swc5-untb/data) available on the CDC website. Relevant variables from this dataset in 2020 were aggregated with the county-level opioid prescribing dataset and the drug overdose by FIPS code 

County-level data on opioid-specific overdose mortality are not publicly available, but county-level data on drug overdose over time is available from the [National Center for Health Statistics](https://data.cdc.gov/NCHS/NCHS-Drug-Poisoning-Mortality-by-County-United-Sta/pbkm-d27e). Despite the limitation of the lack of county-level data on opioid overdose deaths specifically, the preponderance of drug overdose deaths in the US are attributable to prescription or illicit opioids. For example, in 2020 there were 95,452 drug overdose deaths of which 71,487 (74.9%) were due to opioids. Therefore, county-level drug overdose deaths were used to evaluate the relationship between drug overdose mortality rates, prescription opioid prescribing, and social determinants of health in 2020. The relationships between these variables were characterized in univariable and multivariable linear regression models to evaluate the relative contribution of various factors in county-level drug overdose mortality rates. The specific county-level health indicators included the following variables in adults: binge drinking prevalence, depression prevalence, current smoking status, lack of health insurance, obesity prevalence, self-reported lack of leisure time, and self-reported poor recent physical health.

At various times throughout this project, I consulted with Prof. John Farrar, Professor of Epidemiology at the University of Pennsylvania, who is an expert in treatments for pain. My GitHub repository containing all information needed to reproduce these analyses as well as this HTML file can be found [here](https://github.com/cjm2718/BMIN503_Final_Project).

```{r eval = TRUE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = "C:\\Users\\cjm2718\\Dropbox\\Penn\\BMIN 5030\\Final Project Data\\")
library(tidyverse)
library(ggplot2)
library(GGally)
library(sf)
library(tidycensus)
library(leaflet)
library(RColorBrewer)
library(readxl)
library(gridExtra)
library(grid)
library(clinUtils)
library(plotly)
library(gtsummary)
library(kableExtra)
library(viridis)
library(glmnet)
library(car)
library(lubridate)
library(caret)

## import county-level prescription opioid dispensing rates by year
county.disp.2015 <- read_excel("county_dispensing_rates_2015.xlsx")
county.disp.2016 <- read_excel("county_dispensing_rates_2016.xlsx")
county.disp.2017 <- read_excel("county_dispensing_rates_2017.xlsx")
county.disp.2018 <- read_excel("county_dispensing_rates_2018.xlsx")
county.disp.2019 <- read_excel("county_dispensing_rates_2019.xlsx")
county.disp.2020 <- read_excel("county_dispensing_rates_2020.xlsx")


## merge all county-level prescription opioid dispensing datasets
# calculate percent change from 2015 to 2020 and truncated variable at â‰¥100%
county.disp <- full_join(county.disp.2015, county.disp.2016, by = "FIPS.code") %>% 
  full_join(., county.disp.2017, by = "FIPS.code") %>% 
  full_join(., county.disp.2018, by = "FIPS.code") %>% 
  full_join(., county.disp.2019, by = "FIPS.code") %>% 
  full_join(., county.disp.2020, by = "FIPS.code") %>% 
  mutate(disp.rate.2015 = as.numeric(gsub("-", "", disp.rate.2015))) %>% 
  mutate(disp.rate.2016 = as.numeric(gsub("-", "", disp.rate.2016))) %>% 
  rename("county" = "county.y.y.y") %>% 
  rename("state" = "state.y.y.y") %>% 
  mutate(perc.chg.15.20 = ((disp.rate.2020 - disp.rate.2015) / disp.rate.2015 * 100)) %>% 
  mutate(perc.chg.15.20.trunc = ifelse(perc.chg.15.20 >100, 100, perc.chg.15.20)) %>% 
  select(c("state", "county", "FIPS.code", "disp.rate.2015", "disp.rate.2016", "disp.rate.2017",
           "disp.rate.2018", "disp.rate.2019", "disp.rate.2020", "perc.chg.15.20",
           "perc.chg.15.20.trunc")) %>% 
  drop_na("county")

## import county-level geometry data
counties <- readRDS(gzcon(url(
  "https://raw.githubusercontent.com/HimesGroup/BMIN503/master/DataFiles/uscounties_2010.rds")))

## create FIPS.code for merge with county-level opioid dispensing data
counties <- counties %>% 
  mutate(FIPS.code = as.numeric(paste0(STATE, COUNTY)))

## merge counties maps data and dispensing data
# create truncated variables at 150 prescriptions/100 people for maps 
county.disp.map <- merge(county.disp, counties, by.x = "FIPS.code", by.y = "FIPS.code") %>% 
  mutate(disp.rate.2015.gt100 = ifelse(disp.rate.2015 > 100, 1, 0)) %>% 
  mutate(disp.rate.2020.gt100 = ifelse(disp.rate.2020 > 100, 1, 0)) %>% 
  mutate(disp.rate.2015.trunc = ifelse(disp.rate.2015 > 150, 150, disp.rate.2015)) %>% 
  mutate(disp.rate.2016.trunc = ifelse(disp.rate.2016 > 150, 150, disp.rate.2016)) %>%
  mutate(disp.rate.2017.trunc = ifelse(disp.rate.2017 > 150, 150, disp.rate.2017)) %>%
  mutate(disp.rate.2018.trunc = ifelse(disp.rate.2018 > 150, 150, disp.rate.2018)) %>%
  mutate(disp.rate.2019.trunc = ifelse(disp.rate.2019 > 150, 150, disp.rate.2019)) %>%
  mutate(disp.rate.2020.trunc = ifelse(disp.rate.2020 > 150, 150, disp.rate.2020))

## import VSRR on state-level opioid overdose death data by drug type
vsrr <- read.csv("VSRR_Provisional_Drug_Overdose_Death_Counts.csv")

## create dataset to plot drug overdose rates over time in the US
vsrr.us <- vsrr %>% 
  filter(State=="US" & Indicator %in% c("Natural & semi-synthetic opioids, incl. methadone (T40.2, T40.3)",
                                        "Synthetic opioids, excl. methadone (T40.4)",
                                        "Heroin (T40.1)",
                                        "Opioids (T40.0-T40.4,T40.6)")) %>% 
  mutate(tmp = paste(Month, Year)) %>% 
  mutate(Time = parse_date_time(tmp, "my", tz="CET"))

## import NCHS data on county-level data on drug overdose death rates overall
nchs <- read.csv("NCHS_-_Drug_Poisoning_Mortality_by_County__United_States.csv")
nchs <- nchs %>% 
  rename("FIPS.code" = "FIPS") 

## create dataset for mapping drug overdose death by county
# create truncated variable for death rate for mapping
nchs.map <- left_join(nchs, counties, by = "FIPS.code") %>% 
  mutate(deathrate.trunc = ifelse(Model.based.Death.Rate > 60, 60, Model.based.Death.Rate)) 

## create dataset restricted to 2020 for modeling of risk factors
nchs.2020 <- nchs %>% filter(Year==2020)

## import PLACES data on county-level health indicators
places <- read.csv("PLACES__Local_Data_for_Better_Health__County_Data_2022_release.csv")

## include only questions of interest from 2020 data and transform dataset from long to wide format
places.2020 <- places %>% 
  filter(Year==2020 & Data_Value_Type=="Age-adjusted prevalence" & Short_Question_Text %in% c(
    "General Health",
    "Depression", 
    "Sleep < 7 hours",
    "Health Insurance",
    "Obesity",
    "Binge Drinking",
    "Physical Health",
    "Current Smoking",
    "Physical Inactivity",
    "Mental Health",
    "Annual Checkup")) %>% 
  filter(!StateAbbr=="US") %>% 
  rename("FIPS.code" = "LocationID") %>% 
  select(c("Year", "StateAbbr", "StateDesc", "LocationName", "FIPS.code", 
           "Short_Question_Text", "Data_Value")) %>% 
  spread(Short_Question_Text, Data_Value)

## join county-level PLACES dataset and dispensing data
# log transform model-based death rate for later analysis
# scale variable to represent 10-person per 100 resident increase in dispensing rates 
# scale variables to represent 5 percentage point increases in prevalence of risk factors
risk.data <- left_join(places.2020, county.disp.2020, by = "FIPS.code") %>% 
  left_join(., nchs.2020, by = "FIPS.code") %>% 
  rename(`No Health Insurance` = `Health Insurance`) %>%
  mutate(logdeathrate = log(Model.based.Death.Rate)) %>% 
  mutate(opioid.rx.10 = disp.rate.2020/10) %>% 
  mutate(`No Annual Checkup` = 100 - `Annual Checkup`) %>% 
  mutate(no.checkup.5 = `No Annual Checkup` / 5) %>% 
  mutate(poor.gen.health.5 = `General Health` / 5) %>% 
  mutate(depression.5 = `Depression` / 5) %>% 
  mutate(no.insurance.5 = `No Health Insurance` / 5) %>% 
  mutate(obesity.5 = `Obesity` / 5) %>% 
  mutate(binge.drink.5 = `Binge Drinking` / 5) %>% 
  mutate(poor.phys.health.5 = `Physical Health` / 5) %>% 
  mutate(current.smoke.5 = `Current Smoking` / 5) %>% 
  mutate(phys.inactive.5 = `Physical Inactivity` / 5) %>% 
  mutate(mental.health.5 = `Mental Health` / 5)
```

# Results
## Opioid Overdose Deaths Over Time by Opioid Type

During the period of interest, the number of opioid overdose deaths more than doubled from approximately 30,000 per year in 2015 to 65,000 per year in 2020. In 2015, most of the approximately 30,000 opioid overdose deaths were due to natural and semi-synthetic opioids, which are prescription opioids such as oxycodone, morphine, and hydrocodone. Slightly fewer opioid overdose deaths in 2015 were due to heroin and the smallest number were attributable to synthetic opioids, which includes prescription and illicit fentanyl and fentanyl analogs. After 2016, the number of opioid deaths increased dramatically, driven almost entirely by overdose deaths due to synthetic opioids. While prescription opioids may still serve as a gateway to the misuse and abuse of opioids, it remains unclear how opioid prescribing and dispensing practices are associated with drug overdose rates in this new phase of the opioid epidemic.

```{r eval = TRUE, message = FALSE, warning = FALSE, fig.height=6, fig.width=12}
vsrr.us.plot <- vsrr.us %>% 
  filter(Year <= 2020) %>% 
  select(Time, Indicator, Predicted.Value) %>% 
  mutate(`Number of Deaths` = as.numeric(gsub(",", "", Predicted.Value))) %>% 
  arrange(desc(Time), Indicator) %>% 
  rename("Opioid Type" = "Indicator") %>% 
  mutate(`Opioid Type` = factor(`Opioid Type`, 
                                levels = c("Opioids (T40.0-T40.4,T40.6)",
                                 "Synthetic opioids, excl. methadone (T40.4)",
                                 "Natural & semi-synthetic opioids, incl. methadone (T40.2, T40.3)",
                                 "Heroin (T40.1)")))

ggplot(vsrr.us.plot, aes(x=Time, y=`Number of Deaths`, colour=`Opioid Type`)) +
  geom_line(size=1.5) + theme_classic(base_size=13) + 
  labs(title = "Opioid Overdose Death Rate by Opioid Type (2015-2020)")

```


## Prescription Opioid Dispensing Rates
In 2015, prescription opioid dispensing rates exceeded 100 prescriptions per 100 people in 855 (29.1%) of the 2,938 counties in the US reporting data. The counties with the highest rate of prescription opioid dispensing in 2015 were in Virginia, Kentucky, and Alabama. In the 10 counties with the highest rates of dispensing in 2015, more than 250 opioid prescriptions were dispensed per 100 residents, or 2.5 opioid prescriptions filled for every man, woman, and child in that year. 

```{r eval = TRUE, message = FALSE, warning = FALSE}
# number and percent of counties with dispensing rate >100 prescriptions per 100 people in 2015
county.disp.map %>% 
  summarize(Data2015_Available = sum(!is.na(disp.rate.2015)),
            Counties2015_GT_100 = sum(disp.rate.2015.gt100, na.rm = TRUE),
            Per_Counties2015_GT_100 = round(100 * mean(disp.rate.2015.gt100, na.rm = TRUE), 2))

# counties with highest dispensing rates in 2015
county.disp.map %>% 
  select(county, state, disp.rate.2015) %>% 
  arrange(-disp.rate.2015) %>% 
  slice(1:20)
```

The proportion of counties where opioid dispensing rates exceeded 100 prescriptions per 100 people fell considerably by 2020. Of the 3,049 counties reporting data, only 112 (3.7%) had one opioid prescription filled for every resident. The counties with the highest rates of prescribing remained in Virginia and Kentucky.

```{r eval = TRUE, message = FALSE, warning = FALSE}
# number and percent of counties with dispensing rate >100 prescriptions per 100 people in 2020
county.disp.map %>% 
  summarize(Data2020_Available = sum(!is.na(disp.rate.2020)),
            Counties2020_GT_100 = sum(disp.rate.2020.gt100, na.rm = TRUE),
            Per_Counties2020_GT_100 = round(100 * mean(disp.rate.2020.gt100, na.rm = TRUE), 2))

# counties with highest dispensing rates in 2020
county.disp.map %>% 
  select(county, state, disp.rate.2020) %>% 
  arrange(-disp.rate.2020) %>% 
  slice(1:20)
```

The substantial reduction in prescription opioid dispensing rates over time is evident from choropleth maps by county for each year between 2015 and 2020. In 2015, the highest rates of prescription opioid dispensing were observed in the Southeast and the Northwest. While the overall downward trend in opioid dispensing is evident every year, the most substantial year-over-year change appeared to occur between 2018 and 2019, particularly in the Southeast US. 

```{r eval = TRUE, message = FALSE, warning = FALSE}
#  color palette and theme elements
myPalette <- colorRampPalette(brewer.pal(6, "Blues"))
my_theme <- function() {
  theme_minimal() +                                  
  theme(axis.line = element_blank(),                 
        axis.text = element_blank(),                 
        axis.title = element_blank(),
        panel.grid = element_line(color = "white"),  
        legend.key.size = unit(0.4, "cm"),           
        legend.text = element_text(size = 12),       
        legend.title = element_text(size = 12))      
}

# choropleth map of opioid dispensing rates (2015)
disp.2015 <- ggplot() +
  geom_sf(data = county.disp.map, aes(geometry = geometry, fill = disp.rate.2015.trunc), lty=0) +
  my_theme() +                                          
  ggtitle("2015") + 
  scale_fill_viridis(name = "Prescriptions \nper 100 people",      
                     labels = c("0", "50", "100", "â‰¥150"),
                     breaks = c(0, 50, 100, 150), option = "mako", direction = -1) + 
  theme(legend.title = element_text(size = 7), 
               legend.text = element_text(size = 7))

# choropleth map of opioid dispensing rates (2016)
disp.2016 <- ggplot() +
  geom_sf(data = county.disp.map, aes(geometry = geometry, fill = disp.rate.2016.trunc), lty=0) +
  my_theme() +                                          
  ggtitle("2016") + 
  scale_fill_viridis(name = "Prescriptions \nper 100 people",      
                     labels = c("0", "50", "100", "â‰¥150"),
                     breaks = c(0, 50, 100, 150), option = "mako", direction = -1) +
  theme(legend.title = element_text(size = 7), 
               legend.text = element_text(size = 7))

# choropleth map of opioid dispensing rates (2017)
disp.2017 <- ggplot() +
  geom_sf(data = county.disp.map, aes(geometry = geometry, fill = disp.rate.2017.trunc), lty=0) +
  my_theme() +                                          
  ggtitle("2017") + 
  scale_fill_viridis(name = "Prescriptions \nper 100 people",      
                     labels = c("0", "50", "100", "â‰¥150"),
                     breaks = c(0, 50, 100, 150), option = "mako", direction = -1) +
  theme(legend.title = element_text(size = 7), 
               legend.text = element_text(size = 7))

# choropleth map of opioid dispensing rates (2018)
disp.2018 <- ggplot() +
  geom_sf(data = county.disp.map, aes(geometry = geometry, fill = disp.rate.2018.trunc), lty=0) +
  my_theme() +                                          
  ggtitle("2018") + 
  scale_fill_viridis(name = "Prescriptions \nper 100 people",      
                     labels = c("0", "50", "100", "â‰¥150"),
                     breaks = c(0, 50, 100, 150), option = "mako", direction = -1) +
  theme(legend.title = element_text(size = 7), 
               legend.text = element_text(size = 7))

# choropleth map of opioid dispensing rates (2019)
disp.2019 <- ggplot() +
  geom_sf(data = county.disp.map, aes(geometry = geometry, fill = disp.rate.2019.trunc), lty=0) +
  my_theme() +                                          
  ggtitle("2019") + 
  scale_fill_viridis(name = "Prescriptions \nper 100 people",      
                     labels = c("0", "50", "100", "â‰¥150"),
                     breaks = c(0, 50, 100, 150), option = "mako", direction = -1) + 
  theme(legend.title = element_text(size = 7), 
               legend.text = element_text(size = 7))

# choropleth map of opioid dispensing rates (2020)
disp.2020 <- ggplot() +
  geom_sf(data = county.disp.map, aes(geometry = geometry, fill = disp.rate.2020.trunc), lty=0) +
  my_theme() +                                          
  ggtitle("2020") + 
  scale_fill_viridis(name = "Prescriptions \nper 100 people",      
                     labels = c("0", "50", "100", "â‰¥150"),
                     breaks = c(0, 50, 100, 150), option = "mako", direction = -1) +
  theme(legend.title = element_text(size = 7), 
               legend.text = element_text(size = 7))

# show opioid prescribing rate maps (2015-2020) in a grid
grid.arrange(disp.2015, disp.2016, disp.2017, disp.2018, disp.2019, disp.2020, 
             top = textGrob("Opioid Dispensing Rates per 100 People",
             gp = gpar(fontsize=18, font=2)))

```

## Relative Changes in Prescription Opioid Dispensing
Nationally, 89.6% of the counties in the United States with available data reported a decrease in prescription opioid dispensing from 2015 to 2020. At the county level, the median decrease in the rate of prescription opioids dispensed was 53.2% (interquartile range, 33.8% to 67.2%). 

```{r eval = TRUE, message = FALSE, warning = FALSE}
# percent of counties reporting a decrease in opioid prescribing from 2015 to 2020
county.disp.map %>% 
  mutate(disp.dec = ifelse(perc.chg.15.20 < 0, 1, 0)) %>% 
  summarise(`% Counties Decrease in Rate` = 100 * mean(disp.dec, na.rm = TRUE))

# median and IQR of percent change in prescribing from 2015 to 2020
quantile(county.disp.map$perc.chg.15.20, probs = c(0.1, 0.25, 0.5, 0.75, 0.9), na.rm = TRUE)
```

The percent change in prescription opioid dispensing from 2015 to 2020 was generally consistent throughout the entire country. Several counties in the Great Plains region and Inner Midwest had appreciable relative increases in opioid dispensing over the 5-year period, however these large relative increases were attributable to the very low dispensing rates recorded in 2015 (i.e., <3 prescriptions per 100 residents per year). 

```{r eval = TRUE, message = FALSE, warning = FALSE, fig.height=6, fig.width=12}
# color palette and theme elements
myPalette <- colorRampPalette(brewer.pal(6, "Blues"))
my_theme <- function() {
  theme_minimal() +                                  
  theme(axis.line = element_blank(),                 
        axis.text = element_blank(),                 
        axis.title = element_blank(),
        panel.grid = element_line(color = "white"),  
        legend.key.size = unit(0.4, "cm"),           
        legend.text = element_text(size = 12),       
        legend.title = element_text(size = 12))      
}

# choropleth map of percent change in opioid prescribing rates (2015 to 2020)
ggplot() + 
  geom_sf(data = county.disp.map, aes(geometry = geometry, fill = perc.chg.15.20.trunc), lty=0) +
  my_theme() +                                          
  ggtitle("Percent Change in Prescribing Rates") + 
  scale_fill_viridis(name = "Percent Change in Dispensing Rate",      
                    labels = c("-100%", "-50%", "0%", "50%", "â‰¥100%"),
                    breaks = c(-100, -50, 0, 50, 100), option = "turbo") +
  labs(caption = "Note: values truncated above 100%.") + 
  theme(legend.title = element_text(size = 8), 
               legend.text = element_text(size = 8))

# summary of counties with higher percent change in dispensing rates from 2015 to 2020
county.disp.map %>% 
  select(county, state, disp.rate.2015, disp.rate.2020, perc.chg.15.20) %>% 
  arrange(-perc.chg.15.20) %>% 
  slice(1:20)
```


## Drug Overdose Rates

[National CDC data](https://www.cdc.gov/nchs/data/databriefs/db394-tables-508.pdf) shows that the age-adjusted drug overdose rate in the US increased 73.6% from 16.3 deaths per 100,000 people in 2015 to 28.3 per 100,000 people in 2020. In 2015, only 18 counties (0.6%) in the US had a drug overdose death rate >50 per 100,000 per year. But by 2020, 166 counties (5.3%) had a drug overdose death rate >50 per 100,000. There was also considerable regional variability in the overdose death rate across all years. The counties with the highest overdose death rates in 2015 and in 2020 tended to be in Appalachia. However, by 2020, drug overdose death rates had spiked in the Southwest, Gulf Coast, South Florida, and New England, as well.

```{r eval = TRUE, message = FALSE, warning = FALSE}
# percent of counties with drug overdose death rate >50 per 100,000 in 2015
nchs.map %>% 
  filter(Year==2015) %>% 
  mutate(deathrate.gt50 = ifelse(Model.based.Death.Rate > 50, 1, 0)) %>% 
  summarise(Data2015_Available = sum(!is.na(Model.based.Death.Rate)),
            `N Counties Death Rate >=50` = sum(deathrate.gt50, na.rm = TRUE),
            `% Counties Death Rate >=50` = 100 * mean(deathrate.gt50, na.rm = TRUE))

# counties with highest drug overdose rates in 2015
nchs.map %>% 
  filter(Year==2015) %>% 
  select(County, Model.based.Death.Rate, 2) %>% 
  arrange(-Model.based.Death.Rate) %>% 
  slice(1:20)

# percent of counties with drug overdose death rate >50 per 100,000 in 2020
nchs.map %>% 
  filter(Year==2020) %>% 
  mutate(deathrate.gt50 = ifelse(Model.based.Death.Rate > 50, 1, 0)) %>% 
  summarise(Data2015_Available = sum(!is.na(Model.based.Death.Rate)),
            `N Counties Death Rate >=50` = sum(deathrate.gt50, na.rm = TRUE),
            `% Counties Death Rate >=50` = 100 * mean(deathrate.gt50, na.rm = TRUE))

# counties with highest drug overdose rates in 2020
nchs.map %>% 
  filter(Year==2020) %>% 
  select(County, Model.based.Death.Rate, 2) %>% 
  arrange(-Model.based.Death.Rate) %>% 
  slice(1:20)

od.2015 <- ggplot() +
  geom_sf(data = subset(nchs.map, Year==2015), 
          aes(geometry = geometry, fill = deathrate.trunc), lty=0) +
  my_theme() +                                          
  ggtitle("2015") + 
  scale_fill_viridis(name = "Overdose Death Rate \nper 100,000 people",      
                    labels = c("0", "20", "40", "â‰¥60"),
                    breaks = c(0, 20, 40, 60), option = "rocket", direction = -1) + 
  theme(legend.title = element_text(size = 7), 
               legend.text = element_text(size = 7))

od.2016 <- ggplot() +
  geom_sf(data = subset(nchs.map, Year==2016), 
          aes(geometry = geometry, fill = deathrate.trunc), lty=0) +
  my_theme() +                                          
  ggtitle("2016") + 
  scale_fill_viridis(name = "Overdose Death Rate \nper 100,000 people",      
                    labels = c("0", "20", "40", "â‰¥60"),
                    breaks = c(0, 20, 40, 60), option = "rocket", direction = -1) +   
  theme(legend.title = element_text(size = 7), 
               legend.text = element_text(size = 7))

od.2017 <- ggplot() +
  geom_sf(data = subset(nchs.map, Year==2017), 
          aes(geometry = geometry, fill = deathrate.trunc), lty=0) +
  my_theme() +                                          
  ggtitle("2017") + 
  scale_fill_viridis(name = "Overdose Death Rate \nper 100,000 people",      
                    labels = c("0", "20", "40", "â‰¥60"),
                    breaks = c(0, 20, 40, 60), option = "rocket", direction = -1) +  
  theme(legend.title = element_text(size = 7), 
               legend.text = element_text(size = 7))

od.2018 <- ggplot() +
  geom_sf(data = subset(nchs.map, Year==2018), 
          aes(geometry = geometry, fill = deathrate.trunc), lty=0) +
  my_theme() +                                          
  ggtitle("2018") + 
  scale_fill_viridis(name = "Overdose Death Rate \nper 100,000 people",      
                    labels = c("0", "20", "40", "â‰¥60"),
                    breaks = c(0, 20, 40, 60), option = "rocket", direction = -1) + 
  theme(legend.title = element_text(size = 7), 
               legend.text = element_text(size = 7))

od.2019 <- ggplot() +
  geom_sf(data = subset(nchs.map, Year==2019), 
          aes(geometry = geometry, fill = deathrate.trunc), lty=0) +
  my_theme() +                                          
  ggtitle("2019") + 
  scale_fill_viridis(name = "Overdose Death Rate \nper 100,000 people",      
                    labels = c("0", "20", "40", "â‰¥60"),
                    breaks = c(0, 20, 40, 60), option = "rocket", direction = -1) +  
  theme(legend.title = element_text(size = 7), 
               legend.text = element_text(size = 7))

od.2020 <- ggplot() +
  geom_sf(data = subset(nchs.map, Year==2020), 
          aes(geometry = geometry, fill = deathrate.trunc), lty=0) +
  my_theme() +                                          
  ggtitle("2020") + 
  scale_fill_viridis(name = "Overdose Death Rate \nper 100,000 people",      
                    labels = c("0", "20", "40", "â‰¥60"),
                    breaks = c(0, 20, 40, 60), option = "rocket", direction = -1) + 
  theme(legend.title = element_text(size = 7), 
               legend.text = element_text(size = 7))

grid.arrange(od.2015, od.2016, od.2017, od.2018, od.2019, od.2020, 
             top = textGrob("Death Rates for Drug Overdose per 100,000 People",
             gp = gpar(fontsize=18, font=2)))
```

## Predictors of County-Level Drug Overdose Death Rate
### Bivariate Analyses
The distribution of the county-level overdose death rates was highly right-skewed, which violates a key assumption of linear models. A log transformation of the death rate normalized the distribution to facilitate linear modeling.

```{r eval = TRUE, message = FALSE, warning = FALSE, fig.height=6, fig.width=12}

hist.death.rate <- ggplot(risk.data, aes(x=Model.based.Death.Rate)) + geom_histogram() + theme_classic() + 
  scale_x_continuous(name = "Overdose Death Rate (2020)")

hist.log.death.rate <- ggplot(risk.data, aes(x=logdeathrate)) + geom_histogram() + theme_classic() + 
  scale_x_continuous(name = "Log Overdose Death Rate (2020)")

grid.arrange(hist.death.rate, hist.log.death.rate, ncol=2, heights=5,
             top = textGrob("Rationale for Log Transform of Overdose Death Rate"))
```

There was a general increasing trend with higher prescription opioid prescribing associated with higher drug overdose death rates. 

```{r eval = TRUE, message = FALSE, warning = FALSE, fig.height=6, fig.width=9}
ggplot(risk.data, aes(disp.rate.2020, logdeathrate)) +
  geom_point() + xlab("Prescription Opioid Dispensing Rate per 100 Residents in 2020") +
  geom_smooth() + ylab("Log Drug Overdose Death Rate in 2020") +
  theme_classic(base_size=13)
```

To evaluate the linear trend, prescription opioid prescribing rates were rescaled to reflect a 10 prescription per 100 resident increase within the county. The county-level association between the drug overdose death rate and log prescription opioid dispensing rate was highly statistically significant (p<0.0001). However, dispensing rates only predicted approximately 5% of the total variance in drug overdose death rates at the county level. 

Since drug overdose deaths was log transformed, the $\beta$ coefficients from these models can be interpreted by exponentiating the coefficient estimate minus 1 times 100% (i.e., $(e^\beta - 1) * 100\%$). For this model, a 10 prescription per 100 resident increase in opioid dispensing at the county level was associated with an average $(e^.039997 - 1) * 100\% = 4.1\%$ increase in the county's drug overdose death rate.

```{r eval = TRUE, message = FALSE, warning = FALSE}
mod1 <- lm(logdeathrate ~ opioid.rx.10, data=risk.data)
summary(mod1)
100*(exp(mod1$coefficients[2]) - 1)
```

The CDC PLACES dataset contains estimated age-adjusted prevalence estimates for various indicators of health within each county. The variables of interest from the dataset were:

* __No Annual Checkup__: Proportion of adults who had a visit to a doctor for a routine checkup in the past year
* __Binge Drinking__: Proportion of adults who had 5 or more alcoholic drinks (males) or 4 or more alcoholic drinks (females) within the past 30 days
* __Current Smoking__: Proportion of adults who currently smoke some days or every day
* __Depression__: Proportion of adults who have had a depressive disorder (depression, major depression, dysthymia, or minor depression)
* __General Health__: Proportion of adults self-reporting 'fair' or 'poor' general health
* __No Health Insurance__: Proportion of adults with any kind of health care coverage, including health insurance, prepaid plans (e.g., HMOs), or government plans (e.g., Medicare, Indian Health Service)
* __Mental Health__: Proportion of adults self-reporting that their mental health was not good for at least 14 of the past 30 days
* __Obesity__: Proportion of adults with obesity (body mass index $\ge$ 30)
* __Physical Health__: Proportion of adults self-reporting that their physical health was not good for at least 14 of the past 30 days
* __Physical Inactivity__: Proportion of adults who reported doing no physical activity or exercise during the past 30 days other than their regular job

The table below provides summary statistics of the prevalence proportions for each of the health indicators.

```{r eval = TRUE, message = FALSE, warning = FALSE}
health.summary <- risk.data %>%
  select(`No Annual Checkup`, `Binge Drinking`, `Current Smoking`, `Depression`, `General Health`,
         `No Health Insurance`, `Mental Health`, `Obesity`, `Physical Health`, `Physical Inactivity`) %>%
  tbl_summary(
    type = all_continuous() ~ "continuous2",
    statistic = all_continuous() ~ c("{mean} ({sd})",
                                     "{median} ({p25}, {p75})", 
                                     "{min}, {max}"),
    missing = "no") %>% 
  modify_caption("**Summary Statistics of County-Level Prevalence (%) of Health Indicators**") %>% 
  bold_labels()

as_kable_extra(health.summary, format = "html", table.attr = "style='width:50%;'") %>% 
  kable_styling(position = "left", htmltable_class = "lightable-classic")
```

<br />
Since there was a potential that the predictor variables to be correlated, a correlation matrix was generated to avoid introducing multicollinearity into multivariable models. The variables that tended to have the highest correlations with other variables were _General Health_, _Physical Health_, _Current Smoking_, and _Mental Health_. 

```{r eval = TRUE, message = FALSE, warning = FALSE}
cor.predictors <- risk.data %>% 
  select(c("disp.rate.2020", "No Annual Checkup", "General Health", "Depression", "No Health Insurance",
           "Obesity", "Binge Drinking", "Physical Health", "Current Smoking", "Physical Inactivity", 
           "Mental Health"))

cor.matrix <- cor(cor.predictors, method = "pearson", use = "complete.obs")
round(cor.matrix, 2)
```

Scatterplots were generated to evaluate the bivariate relationship between health indicators and log drug overdose death rates. Higher county-level prevalence estimates of depression, poor general health, poor physical health, current smoking, physical inactivity, and poor mental health were associated with higher drug overdose death rates. Counterintuitively, the prevalences of no annual checkup, no health insurance, obesity, and binge drinking were inversely related to the drug overdose death rate.

```{r eval = TRUE, message = FALSE, warning = FALSE, fig.height=15, fig.width=12}
plot.nc <- ggplot(risk.data, aes(`No Annual Checkup`, logdeathrate)) +
  geom_point() +  geom_smooth(method='lm', se=FALSE) + theme_classic() + 
  ylab("Log Drug Overdose Death Rate") 

plot.gh <- ggplot(risk.data, aes(`General Health`, logdeathrate)) +
  geom_point() +  geom_smooth(method='lm', se=FALSE) + theme_classic() + 
  ylab("Log Drug Overdose Death Rate") 

plot.dp <- ggplot(risk.data, aes(`Depression`, logdeathrate)) +
  geom_point() +  geom_smooth(method='lm', se=FALSE) + theme_classic() + 
  ylab("Log Drug Overdose Death Rate") 

plot.in <- ggplot(risk.data, aes(`No Health Insurance`, logdeathrate)) +
  geom_point() +  geom_smooth(method='lm', se=FALSE) + theme_classic() + 
  ylab("Log Drug Overdose Death Rate") 

plot.ob <- ggplot(risk.data, aes(`Obesity`, logdeathrate)) +
  geom_point() +  geom_smooth(method='lm', se=FALSE) + theme_classic() + 
  ylab("Log Drug Overdose Death Rate") 

plot.bd <- ggplot(risk.data, aes(`Binge Drinking`, logdeathrate)) +
  geom_point() +  geom_smooth(method='lm', se=FALSE) + theme_classic() + 
  ylab("Log Drug Overdose Death Rate") 

plot.ph <- ggplot(risk.data, aes(`Physical Health`, logdeathrate)) +
  geom_point() +  geom_smooth(method='lm', se=FALSE) + theme_classic() + 
  ylab("Log Drug Overdose Death Rate") 

plot.cs <- ggplot(risk.data, aes(`Current Smoking`, logdeathrate)) +
  geom_point() +  geom_smooth(method='lm', se=FALSE) + theme_classic() + 
  ylab("Log Drug Overdose Death Rate") 

plot.pi <- ggplot(risk.data, aes(`Physical Inactivity`, logdeathrate)) +
  geom_point() +  geom_smooth(method='lm', se=FALSE) + theme_classic() + 
  ylab("Log Drug Overdose Death Rate") 

plot.mh <- ggplot(risk.data, aes(`Mental Health`, logdeathrate)) +
  geom_point() +  geom_smooth(method='lm', se=FALSE) + theme_classic() + 
  ylab("Log Drug Overdose Death Rate") 

grid.arrange(plot.nc, plot.gh, plot.dp, plot.in, plot.ob, plot.bd, plot.ph, plot.cs,
             plot.pi, plot.mh, ncol=2, heights=c(10, 10, 10, 10, 10),
  top = textGrob("Scatter Plots of Prevalence of Health Indicators and Log Overdose Death Rate"))
```

To facilitate interpretability, all variables were scaled to represent 5 percentage-point increases in county-level prevalence in all models. The prevalence of health indicators that predicted the greatest amount of variance in univariable linear regression models were _Depression_ ($R^{2}$=20.3%), _Mental Health_ ($R^{2}$=19.9%), _Binge Drinking_ ($R^{2}$=11.7%), _No Annual Checkup_ ($R^{2}$=6.4%), _Poor Physical Health_ ($R^{2}$=6.2%), and _Current Smoking_ ($R^{2}$=5.1%). As previously noted, _Binge Drinking_ and _No Annual Checkup_ were surprisingly inversely associated with the overdose death rate.

```{r eval = TRUE, message = FALSE, warning = FALSE}
# linear regression models for individual predictors

lm.nc <- lm(logdeathrate ~ no.checkup.5, data=risk.data)
summary(lm.nc)
100*(exp(lm.nc$coefficients[2]) - 1)

lm.gh <- lm(logdeathrate ~ poor.gen.health.5, data=risk.data)
summary(lm.gh)
100*(exp(lm.gh$coefficients[2]) - 1)

lm.dp <- lm(logdeathrate ~ depression.5, data=risk.data)
summary(lm.dp)
100*(exp(lm.dp$coefficients[2]) - 1)

lm.in <- lm(logdeathrate ~ no.insurance.5, data=risk.data)
summary(lm.in)
100*(exp(lm.in$coefficients[2]) - 1)

lm.ob <- lm(logdeathrate ~ obesity.5, data=risk.data)
summary(lm.ob)
100*(exp(lm.ob$coefficients[2]) - 1)

lm.bd <- lm(logdeathrate ~ binge.drink.5, data=risk.data)
summary(lm.bd)
100*(exp(lm.bd$coefficients[2]) - 1)

lm.ph <- lm(logdeathrate ~ poor.phys.health.5, data=risk.data)
summary(lm.ph)
100*(exp(lm.ph$coefficients[2]) - 1)

lm.cs <- lm(logdeathrate ~ current.smoke.5, data=risk.data)
summary(lm.cs)
100*(exp(lm.cs$coefficients[2]) - 1)

lm.pi <- lm(logdeathrate ~ phys.inactive.5, data=risk.data)
summary(lm.pi)
100*(exp(lm.pi$coefficients[2]) - 1)

lm.mh <- lm(logdeathrate ~ mental.health.5, data=risk.data)
summary(lm.mh)
100*(exp(lm.mh$coefficients[2]) - 1)

# table with most important predictors in univariable model
custom.table <- tibble(
  `Variable` = c("Depression", "Mental Health", "Binge Drinking", "No Checkup", 
                 "Physical Health", "Smoking"),
  `R-squared` = c("20.3%", "19.9%", "11.7%", "6.4%", "6.2%", "5.1%"),
  `% Change in Death Rate with 5-Point Change in Prevalence` = 
    c("46.3%", "82.1%", "-26.6%", "-15.9%", "37.5%", "16.4%")
)

kbl(custom.table, format = "html", align = 'l', 
    caption = "Summary of Variables with Highest Predictive Power in Univariable Models") %>% 
  kable_styling(full_width = FALSE)
```

The correlation matrix below shows the colinearity of the opioid dispensing rate and the 6 health indicators that predicted at least 5% of the total variance in drug overdose rates. The prevalence of depression was highly correlated with the prevalence of poor recent mental health ($\rho$ = 0.82). The prevalence of poor self-reported physical health was highly correlated with both current smoking status ($\rho$ = 0.82) and poor self-reported mental health ($\rho$ = 0.86). 

```{r eval = TRUE, message = FALSE, warning = FALSE}
# correlation matrix of opioid prescribing and strongest health predictors
cor.predictors2 <- risk.data %>% 
  select(c("disp.rate.2020", "No Annual Checkup", "Depression", "Binge Drinking", 
           "Physical Health", "Current Smoking", "Mental Health"))

cor.matrix2 <- cor(cor.predictors2, method = "pearson", use = "complete.obs")
round(cor.matrix2, 2)
```

### Multivariable Analyses
To determine which variables contributed unnecessary information to the model, a multivariable linear model with all predictors was fit and the variance inflation factor (VIF) was calculated for all independent variables. A VIF greater than 5 is generally considered to be a high degree of multicollinearity. In the full model, self-reported poor physical health and mental health status had high VIFs. Current smoking status and lack of annual check-up were not statistically significant.

```{r eval = TRUE, message = FALSE, warning = FALSE}
# full multivariable model 
lm.multivar.full <- lm(logdeathrate ~ opioid.rx.10 +  no.checkup.5 + depression.5 + binge.drink.5 + 
                    poor.phys.health.5 + current.smoke.5 + mental.health.5, data=risk.data)
summary(lm.multivar.full)

# variance inflation factor for independent variables in full model
vif(lm.multivar.full)
```

Self-reported poor physical health and poor mental health status were removed from consideration in the final model due to high VIFs and insignificant predictors were also removed from consideration. Three independent predictors remained: prescription opioid dispensing rate, depression prevalence, and binge drinking prevalence. However, the finding that binge drinking was associated with a lower rate of drug overdose death was counterintuitive in that substance abuse of one substance would be expected to be positively assoicated with the abuse of other substances. In evaluating those counties with the highest binge drinking rates, all top 20 counties were in Wisconsin and each county had a lower drug overdose death rate than the national average. Thus, the inverse association between binge drinking prevalence and drug overdose death rate was spurious, driven by distinct regional patterns of alcohol abuse rather than a protective effect of binge drinking.

```{r eval = TRUE, message = FALSE, warning = FALSE}
# counties with highest drug overdose rates in 2015
risk.data %>% 
  select(County, `Binge Drinking`, Model.based.Death.Rate) %>% 
  arrange(-`Binge Drinking`) %>% 
  slice(1:20)
```

Therefore, the final multivariable model included two variables: opioid dispensing rate and the prevalence of depression. The model results suggest that holding the other variable constant:

* For every 10-unit increase in the prescription opioid prescribing rate per 100 people within a county, the drug overdose death rate increases on average by 2.9%
* For every 5-percentage point increase in the prevalence of depression within a county, the drug overdose death rate increases on average by 43.0%

```{r eval = TRUE, message = FALSE, warning = FALSE}
# final exploratory multivariable model 
lm.multivar.2 <- lm(logdeathrate ~ opioid.rx.10 + depression.5, data=risk.data)
summary(lm.multivar.2)

# variance inflation factor for independent variables in final exploratory multivariable model
vif(lm.multivar.2)

# transform coefficient estimates for interpretation
100*(exp(lm.multivar.2$coefficients[2:3]) - 1)
```

### Elastic Net Regression
To ensure that the final model by exploratory analysis was adequately parameterized, elastic net regression was used to evaluate other potential model fits including all predictor variables of interest (with the exception of _Binge Drinking_ which was found to be confounded by state _a priori_). The model was fit using the repeated cross-validation method with 5 folds repeated 5 times. The optimal value for $\alpha$ selected by the model was 0.056 (which is close to 0 that would be equivalent to Ridge regression versus an $\alpha$ of 1 that would be equivalent to Lasso regression) and the optimal value of $\lambda$ was 0.00335. 

The cross-validated elastic net regression model did not exclude any of the predictor variables. Relative to the multivariable model generated via exploratory analysis, the parameter estimates for a 10-person increase in the prescription opioid dispensing rate more than doubled (2.9% vs 7.8% increase in drug overdose rate) but the parameter estimate for a 5 percentage point increase in depression was attenuated (43% vs 28% increase in drug overdose rate). There appeared to be little advantage of the model by elastic net regression from a prediction perspective since the root mean square error (RMSE) was 0.4763 and $R^2$ was 24.4%, which was nearly equivalent to the more parsimonious model selected by exploratory analysis, which had an RMSE of 0.4818 and $R^2$ of 22.6%. Importantly, the elastic net regression model results confirmed that the prevalence of depression was of greater predictive importance than the prescription opioid dispensing rate.

```{r eval = TRUE, message = FALSE, warning = FALSE, fig.height=6, fig.width=9}
# create dataset without any missing values for death rate or opioid prescribing for elastic net regression
set.seed(1001)
risk.data.nomiss <- risk.data %>% 
  filter_at(vars(logdeathrate, opioid.rx.10), all_vars(!is.na(.))) %>% 
  select(logdeathrate, disp.rate.2020, `No Annual Checkup`, `Depression`, 
          `Physical Health`, `Current Smoking`)

# Set control parameters for training via repeated cross-validation method
train.control <- trainControl(method = "repeatedcv",
                              number = 5,
                              repeats = 5,
                              search = "random",
                              verboseIter = FALSE)

# fit predictive elastic net models over different tuning parameters for alpha and lambda
elastic.net.model <- train(logdeathrate ~ .,
                           data = risk.data.nomiss,
                           method = "glmnet",
                           preProcess = c("center", "scale"),
                           tuneLength = 25,
                           trControl = train.control)
elastic.net.model

# report results from final model that optimized RMSE
final.model <- elastic.net.model$finalModel
coef(final.model, s = elastic.net.model$bestTune$lambda)
100*(exp(coef(final.model, s = elastic.net.model$bestTune$lambda)[2:6,]) - 1)
plot(varImp(elastic.net.model,scale=TRUE))
```

# Conclusion
The key finding from these analyses is that regional prescription opioid prescribing is still a significant predictor of drug overdose deaths but only accounts for 5% of the total variance in overdose death rates across counties in the US. The county-level prevalence of poor mental health or depression independently predicts approximately 4 times more variance in drug overdose rates than prescription opioid dispensing rates. This finding is congruent with the observation that the number of opioid overdose deaths attributable to prescription opioids remained unchanged between 2015 and 2020 despite a more than 40% decline in prescribing. The lack of change in overdose deaths due to prescription opioids likely reflects that prescription opioids can still be easily procured by individuals for whom prescription opioids are the opioid of choice for abuse. Notwithstanding the national and regional trends, efforts to reduce unnecessary exposure to opioids among individuals in the community remains the best solution for reducing the incidence of opioid use disorder.

While the opioid epidemic is a national problem, other findings from these analyses underscore the importance of understanding regional dynamics and substance abuse patterns. For example, while opioid abuse is typically associated with the abuse of other drugs and alcohol at the individual level, the prevalence of binge drinking at the county level was negatively associated with drug overdose rates. This association was driven by the very high prevalence of binge drinking in Wisconsin where drug overdose rates are below the national average. Large cohort studies or case-control studies, which can evaluate individual-level factors, would likely be more informative than these county-level summary data in identifying the health factors that predispose an individual to opioid abuse. However, the strong positive association between poor mental health and depression with drug overdose death rates in this analysis is consistent with prior research on risk factors for opioid abuse ([Manchikanti et al, 2007](https://www.wmpllc.org/ojs/index.php/jom/article/view/1172); [Sullivan, 2018](https://www.ingentaconnect.com/content/wk/cjpn/2018/00000034/00000009/art00010)).

A recent paper by [Aubry and Carr (2022)](https://www.frontiersin.org/articles/10.3389/fpain.2022.884674/full) reported on an analysis of prescription opioid sales and prescription opioid deaths on the state level from 2010 to 2019. Their analysis regressed the annual prescription opioid sales on the opioid overdose death rate nationally as well as by state and found a significant negative relationship in most states (i.e., _higher_ opioid doses dispensed per capita were associated with _lower_ overdose death rates). Their finding is attributable to the correlation of two trended time series, which is known to induce spurious relationship. In this case, opioid overdose deaths were increasing over time as a result of the proliferation of fentanyl and other synthetic opioids while prescription opioid dispensing was declining over the same time frame. While there are more appropriate methods for evaluating two trended time series, the present analysis removes the influence of time entirely to show that, indeed, higher opioid prescribing rates remain positively associated with drug overdose death.

Overall, the results of this project suggest that reducing unnecessary prescription opioid exposure should remain a public health priority. In the context of the current state of the opioid epidemic, efforts to reduce the supply of illicit fentanyl and to address the underlying mental health issues leading to substance abuse may be more impactful interventions for reducing opioid overdose deaths.