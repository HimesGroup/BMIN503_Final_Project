---
title: "The Adult Impact of Childhood VCUGs"
subtitle: "BMIN503/EPID600 Final Project"
author: "Andrea McDonald"
format: html
editor: visual
number-sections: true
embed-resources: true
---

------------------------------------------------------------------------

## Overview {#sec-overview}

*Citations and references available upon request*

**An exploratory study on the adult impact of childhood VCUGs**

A Voiding Cystourethrogram (VCUG) is a diagnostic test that allows physicians to examine the urinary system, specifically the bladder and urethra. VCUGs are commonly performed in childhood to evaluate issues such as frequent urinary tract infections (UTIs), investigate abnormalities of the urinary system, or detect vesicoureteral reflux (a condition where urine flows backward from the bladder into the ureters).

The VCUG experience has been poorly documented in children; however, even less is known about the long-term impacts of the procedure. This project explores the prevalence and understanding of various sequelae among adults who underwent VCUG in childhood, while gaining insights into the lived experience of the procedure from the patient perspective.

To explore and understand these relationships, I use data collected from my own study "2023 VCUG Survey" (IRB Protocol #852632), in which responses were collected over nine months (January 2023 - September 2023). Respondents completed a 15-minute survey about their physical and mental health, and were categorized into two groups ("VCUG" and "control") based on whether they did or did not report undergoing at least one VCUG in childhood (\<18 years). I worked with Dr Bonnie Offit, MD and Scott Appel, Co-Director at the University of Pennsylvania Biostatistics Analysis Center, for this project. The preliminary findings from this project will inform next steps I will take in Spring 2024 as I look to publish my findings. For example, I must decide whether or not to incorporate findings from the control group in my published deliverable, or move this project forward as an exploratory research study focusing only on the VCUG group. This will depend on the presence of confounders, sample size, data collection methods, and physician input. Dr. Offit is serving as a physician consultant, advising on the nuances of VCUG ordering and the clinical perspective. Scott has opined on various ways to analyze the data, what might be criticized, and which statistical tests (if any) would be most appropriate for the variables collected.

[**Link to final project GitHub repository**](https://github.com/dremcdonald/DSFinalProject2023)

## Introduction {#sec-introduction}

### **Background of VCUG**

Urinary tract infections (UTIs) are one of the most common bacterial infections in childhood, affecting approximately 7.8% of children \<19 years with urinary symptoms and/or fever (16). Over 30% of children with UTI will have recurrent UTI (15). A common risk factor for recurrence is vesicoureteral reflux (VUR), a pediatric condition in which urine flows backward from the bladder back into the ureters and/or kidneys (16). VUR is important to identify as it leads to an increased risk of persistent and/or recurrent UTIs, and if left untreated, in some cases can cause kidney damage (6), though most children don't have long-term problems from VUR as the condition frequently resolves on its own (17).

The Voiding Cystourethrogram (VCUG) is the primary diagnostic test used to diagnose VUR. As of 2021, there were approximately 73 million children under 18 in the United States (14). From these figures, we can estimate conservatively that around 2 million children in the United States per year with recurrent UTIs will undergo at least one VCUG. This estimate does not consider a) cases where multiple VCUGs are performed on the same child within the year, and b) cases where a child undergoes VCUG after only one UTI. More broadly, between 2 and 5 million children per year in the United States may become candidates for VCUG.

### **Lack of standardized VCUG protocols**

VCUGs are ordered by many specialists and primary care providers, including pediatricians, family practitioners, nephrologists, hospitalists, emergency department physicians, and urologists (18), but protocols and standards for this test vary widely. In 2016, the AAP attempted to publish a consensus on how to perform and interpret the VCUG, acknowledging that an official protocol has not been updated since 1985 (18). Still, no evidence-based or enforced protocol for VCUG exists (18). The AAP acknowledged in 2016 that VCUG is one of the only imaging studies in existence that is regularly performed without national or international consensuses on process, raising concerns about patient safety and proper data/outcomes comparisons. It also notes that the VCUG can be traumatizing for patients and parents alike, though it does not detail to what extent (18).

### **Depiction of VCUG**

*I include in the appendix a transcript of two judges' factual description of the VCUG after viewing a medical videotape of a standard VCUG procedure (20).*

Most institutions describe VCUG as minimally invasive, painless, and without risks outside of standard imaging radiation exposure. However, as early as 1998, VCUGs were identified as potentially highly traumatic experiences. In 2004, VCUG patients were recruited as proxies for childhood sexual abuse victims (4) because "even doctors administering the procedure admit that in many ways the VCUG procedure is similar to sexual assault on a child" (5). An increasing volume of literature warns that the potential psychological trauma resulting from VCUG is analogous with that of a violent rape (19). A growing number of adults (both male and female) are advocating against the procedure and begging for alternatives, citing that, years or even decades later, they refuse to seek healthcare, experience broken relationships, and battle thoughts of suicide as a direct result of having undergone VCUG as children (8).

Until now, no study has ever examined adults who underwent VCUG in childhood to assess whether the procedure has materially affected their lives.

## Methods {#sec-methods}

This survey was distributed and collected using REDCap. To preserve respondent confidentiality, I will not upload the raw data file to GitHub. I will, however, include the data dictionary and the recruitment flyer/IRB approval form. The raw (de-identified) data file is available upon request, only to those who require access for the purposes of validating the project and/or study.

[Step through the survey as if you were a participant here.](https://redcap.link/pcejwgr7)

### Project Aim

This work seeks to:

a\) Define two cohorts -- VCUG and control;

b\) Perform exploratory data analysis to inform whether the sample collected allows for statistical analysis between the VCUG and control groups;

c\) Perform chosen analyses on VCUG and/or control group(s).

### A Note on Previous Data Cleaning History

Certain data cleaning steps were performed in Excel/REDCap prior to this project. Those steps are enumerated below:

-   Removed rows with duplicate entries from the same email; kept either the most complete, or the latest entry

-   Removed "test" entries

-   Removed respondents who exited survey before completing the main survey

-   Removed identifiable information such as email addresses

## Approach

### Packages, Table, Inspection, Cleanup

Load the necessary packages (assuming they're previously installed).

```{r}
# Load packages
library(tidyverse)
library(ggplot2)
library(dplyr)
```

Read in the raw data table.

```{r}
# Read in table.
t <- read.csv("C:\\Users\\mcdonalda2\\OneDrive - Children's Hospital of Philadelphia\\Desktop\\VCUG Study\\Data\\vcugdataraw.csv")

```

Perform some inspection.

```{r}
# Perform initial inspection of data.
str(t)
```

Perform data cleanup to more effectively analyze my information.

```{r}

# Perform data cleanup on the main table.

# Change indicators to clarify sex at birth.
t$sex_at_birth <- factor(t$sex_at_birth, levels = c(1, 2), labels = c("male", "female"))

# Change indicators to clarify education level.
t$education_level <- factor(t$education_level, levels = c(1,2,3,4,5,6,7,8,9,10,11), labels = c("never attended","elementary","middle","high/ged","some college","associate","bachelor","master","professional","doctoral","other"))

# Change indicators to clarify race.
t$race <- factor(t$race, levels = c(1,2,3,4,5,6,7), labels = c("NAHPI","AIAN","asian","black or AA","white","HisLat","other"))


# Change indicators to clarify vcug case and control status.
t$vcug_indicator <- factor(t$vcug_indicator, levels = c(0, 1), labels = c("control", "vcug"))

# Change indicators to clarify survey source.
t$survey_source <- factor(t$survey_source, levels = c(1,2,3,4,5,6,7), labels = c("linkedin", "twitter","instagram","reddit","organization","WOM","other"))   


# Now I want to convert all the other columns in my data frame that have only 0s and 1s to "no" and "yes". I confirmed this was appropriate for all remaining columns by verifying with the data dictionary.

# Create a function to identify columns that contain only 0s and 1s.
binary_cols <- sapply(t, function(x) all(x %in% c(0, 1)))
# Convert those columns to factors with 'No' and 'Yes' labels.
t[binary_cols] <- lapply(t[binary_cols], function(x) factor(x, levels = c(0, 1), labels = c("No", "Yes")))

```

### Exploratory Data Analysis - Demographics

Perform some EDA to understand demographics of the dataset.

```{r}
# Look at some demographic splits.
table(t$vcug_indicator)
table(t$sex_at_birth)

# Bar chart of sex.
ggplot(t, aes(x = sex_at_birth)) +
  geom_bar(fill = "skyblue", color = "black") +
  labs(title = "Respondents by Sex", x = "Sex", y = "Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Bar chart of race distribution.
ggplot(t, aes(x = race)) +
  geom_bar(fill = "skyblue", color = "black") +
  labs(title = "Race", x = "Race", y = "Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Bar chart of education level.
ggplot(t, aes(x = education_level)) +
  geom_bar(fill = "skyblue", color = "black") +
  labs(title = "Education Level", x = "Education", y = "Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Histogram of age distribution.
hist(t$age, main = "Respondents' Ages", xlab = "Age", col = "blue")

# Box plot of age distribution.
boxplot(t$age, main = "Respondents' Ages", ylab = "Age", horizontal = TRUE, col = "lightblue")

# Summary statistics of age range of respondents.
# Get minimum age, maximum age, mean, and median
min_age <- min(t$age, na.rm = TRUE)
max_age <- max(t$age, na.rm = TRUE)
mean_age <- mean(t$age, na.rm = TRUE)
median_age <- median(t$age, na.rm = TRUE)
# Print the summary statistics
cat("Min Age:", min_age, "\n")
cat("Max Age:", max_age, "\n")
cat("Mean Age:", mean_age, "\n")
cat("Median Age:", median_age, "\n")

# I want to bracket my age groups to get a better understanding of distribution.
# Define the breaks for the age groups
breaks <- c(17, 34, 54, Inf)  # Start with 17 to include 18 in the first bracket
# Define the labels for the age groups
labels <- c("18-34", "35-54", "55+")
# Create the age group column
t$age_group <- cut(t$age, breaks = breaks, labels = labels, right = FALSE)

# Bar chart of age groups.
ggplot(t, aes(x = age_group)) +
  geom_bar(fill = "skyblue", color = "black") +
  labs(title = "Age group distribution", x = "Age group", y = "Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# What was the source that my respondents found my survey from?
ggplot(t, aes(x = survey_source)) +
  geom_bar(fill = "skyblue", color = "black") +
  labs(title = "Survey Source", x = "Source", y = "Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

**Takeaways:**

-   I collected nearly double the female respondents as I did male respondents.

-   I collected nearly double the VCUG patients as I did controls.

-   My sample is not diverse - predominantly white.

-   Most of my sample completed at least high school or a GED equivalent. The majority completed some form of college or advanced degree.

-   Age distribution for my sample:

    -   Range: 18-70 years old

    -   Mean Age: 31

    -   Median Age: 28

    -   Most of my respondents are between 18 and 34 years old, but a good amount are between 35-54. A small percentage are 55+ years old.

-   My survey source distribution is well-distributed, which is encouraging. It should be noted (this analysis was performed in Excel, but it's worth mentioning) that nearly every respondent who discovered this survey via Reddit found it through the subreddit r/VCUGTrauma or a related medical trauma subreddit. This suggests a heavy amount of trauma-leaning bias in the sample.

```{r}
# I want to dig into the source further because it's important. I will split my source by VCUG and controls.

# Survey source by VCUG indicator
ggplot(t, aes(x = survey_source, fill = vcug_indicator)) +
  geom_bar(position = "fill") +
  scale_y_continuous(labels = scales::percent_format()) +  # Convert y-axis to percent
  labs(title = "Proportional Survey Source by VCUG Indicator",
       x = "Survey Source",
       y = "Proportion") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x labels for better readability
```

This proportion distribution shows that my VCUG and control groups heard about my survey through pretty different sources, suggesting quite a bit of bias in my sample. I would ideally like this graph to look 50/50 in distribution, knowing what I know about Reddit as a source.

Let's dig in further. I want to do some stratified summary statistics to see if I collected comparable data from other demographic perspectives across my VCUG and control group splits.

```{r}
# Boxplot of age by VCUG indicator group
boxplot(age ~ vcug_indicator, data = t, main = "Age by VCUG Indicator Group",
        xlab = "Group", ylab = "Age", col = c("lightblue", "pink"))

# Bar chart of sex by VCUG indicator group, proportional
# Create a bar chart with proportions
ggplot(t, aes(x = vcug_indicator, fill = sex_at_birth)) +
  geom_bar(position = "fill") +
  scale_y_continuous(labels = scales::percent) + # Convert y-axis to percent
  labs(title = "Proportion of Sex by VCUG Indicator Group",
       x = "VCUG Indicator Group",
       y = "Proportion") +
  scale_fill_brewer(palette = "Pastel1") +
  theme_minimal()

# Bar chart of race by VCUG indicator group, proportional
# Create a bar chart with proportions
ggplot(t, aes(x = vcug_indicator, fill = race)) +
  geom_bar(position = "fill") +
  scale_y_continuous(labels = scales::percent) + # Convert y-axis to percent
  labs(title = "Proportion of Race by VCUG Indicator Group",
       x = "VCUG Indicator Group",
       y = "Proportion") +
  scale_fill_brewer(palette = "Pastel1") +
  theme_minimal()

# Bar chart of age group by VCUG indicator, proportional
# Create a bar chart with proportions
ggplot(t, aes(x = vcug_indicator, fill = age_group)) +
  geom_bar(position = "fill") +
  scale_y_continuous(labels = scales::percent) + # Convert y-axis to percent
  labs(title = "Proportion of Age Brackets by VCUG Indicator Group",
       x = "VCUG Indicator Group",
       y = "Proportion") +
  scale_fill_brewer(palette = "Pastel1") +
  theme_minimal()

```

**Takeaways:**

-   Stratified sex distribution was balanced, though leaning female.

-   Stratified age distribution was balanced, concentrated in the 18-35 range for both groups. Control group saw more outliers in older age brackets.

-   My VCUG group is more diverse than my control group, but not by too much. Overall, the sample is heavily white-leaning, which needs improvement if we were to repeat this study.

### Data Analysis - *How would you rate your overall physical and mental health?*

I want to analyze how healthy the respondents in each group perceive themselves to be, by looking at the distribution and relationship of these self-reported health ratings within the case and control groups.

```{r}
# Create a new table with selected columns
health_rating <- t %>%
  select(vcug_indicator, phys_health_rating, ment_health_rating)

# Summary statistics for physical and mental health ratings stratified by VCUG indicator
health_stats <- health_rating %>%
  group_by(vcug_indicator) %>%
  summarise(
    phys_health_mean = mean(phys_health_rating, na.rm = TRUE),
    phys_health_sd = sd(phys_health_rating, na.rm = TRUE),
    phys_health_median = median(phys_health_rating, na.rm = TRUE),
    ment_health_mean = mean(ment_health_rating, na.rm = TRUE),
    ment_health_sd = sd(ment_health_rating, na.rm = TRUE),
    ment_health_median = median(ment_health_rating, na.rm = TRUE),
  )

print(health_stats)

# Visual Comparisons

# Physical Health Rating Boxplot
ggplot(health_rating, aes(x = vcug_indicator, y = phys_health_rating, fill = vcug_indicator)) +
  geom_boxplot() +
  labs(title = "Physical Health Rating by VCUG Indicator Group",
       x = "VCUG Indicator Group",
       y = "Physical Health Rating") +
  theme_minimal()

# Mental Health Rating Boxplot
ggplot(health_rating, aes(x = vcug_indicator, y = ment_health_rating, fill = vcug_indicator)) +
  geom_boxplot() +
  labs(title = "Mental Health Rating by VCUG Indicator Group",
       x = "VCUG Indicator Group",
       y = "Mental Health Rating") +
  theme_minimal()
```

**Takeaways:**

-   Both physical and mental health are self-reported lower in the VCUG group than the control group.

### Data Analysis - *Have you ever been diagnosed with...?*

The following section explores whether respondents have been diagnosed with, or think they might have: depression, anxiety, bipolar disorder, PTSD, OCD, misophonia, PGAD, and/or HPF. Disease explanations can be found in the data dictionary.

```{r}
# Create a new table with selected columns
diagnoses <- t %>%
  select(vcug_indicator, anxiety_ind, depression_ind, bipolar_ind, ptsd_ind, ocd_ind, misophonia_ind, pgad_ind, hpf_ind)

# Change indicators to clarify 1 = no, 2 = yes, 3 = undiagnosed but sounds like something i might have.
diagnoses$anxiety_ind <- factor(diagnoses$anxiety_ind, levels = c(1, 2, 3), labels = c("no", "yes", "undiagnosed, sounds right"))

diagnoses$depression_ind <- factor(diagnoses$depression_ind, levels = c(1, 2, 3), labels = c("no", "yes", "undiagnosed, sounds right"))

diagnoses$bipolar_ind <- factor(diagnoses$bipolar_ind, levels = c(1, 2, 3), labels = c("no", "yes", "undiagnosed, sounds right"))

diagnoses$ptsd_ind <- factor(diagnoses$ptsd_ind, levels = c(1, 2, 3), labels = c("no", "yes", "undiagnosed, sounds right"))

diagnoses$ocd_ind <- factor(diagnoses$ocd_ind, levels = c(1, 2, 3), labels = c("no", "yes", "undiagnosed, sounds right"))

diagnoses$misophonia_ind <- factor(diagnoses$misophonia_ind, levels = c(1, 2, 3), labels = c("no", "yes", "undiagnosed, sounds right"))

diagnoses$pgad_ind <- factor(diagnoses$pgad_ind, levels = c(1, 2, 3), labels = c("no", "yes", "undiagnosed, sounds right"))

diagnoses$hpf_ind <- factor(diagnoses$hpf_ind, levels = c(1, 2, 3), labels = c("no", "yes", "undiagnosed, sounds right"))


# Bar chart of anxiety by VCUG indicator, proportional
# Create a bar chart with proportions
ggplot(diagnoses, aes(x = vcug_indicator, fill = anxiety_ind)) +
  geom_bar(position = "fill") +
  scale_y_continuous(labels = scales::percent) + # Convert y-axis to percent
  labs(title = "Proportion of Anxiety by VCUG Indicator Group",
       x = "VCUG Indicator Group",
       y = "Proportion") +
  scale_fill_brewer(palette = "Pastel1") +
  theme_minimal()

# Bar chart of depression by VCUG indicator, proportional
# Create a bar chart with proportions
ggplot(diagnoses, aes(x = vcug_indicator, fill = depression_ind)) +
  geom_bar(position = "fill") +
  scale_y_continuous(labels = scales::percent) + # Convert y-axis to percent
  labs(title = "Proportion of Depression by VCUG Indicator Group",
       x = "VCUG Indicator Group",
       y = "Proportion") +
  scale_fill_brewer(palette = "Pastel1") +
  theme_minimal()

# Bar chart of bipolar by VCUG indicator, proportional
# Create a bar chart with proportions
ggplot(diagnoses, aes(x = vcug_indicator, fill = bipolar_ind)) +
  geom_bar(position = "fill") +
  scale_y_continuous(labels = scales::percent) + # Convert y-axis to percent
  labs(title = "Proportion of BPD by VCUG Indicator Group",
       x = "VCUG Indicator Group",
       y = "Proportion") +
  scale_fill_brewer(palette = "Pastel1") +
  theme_minimal()

# Bar chart of PTSD by VCUG indicator, proportional
# Create a bar chart with proportions
ggplot(diagnoses, aes(x = vcug_indicator, fill = ptsd_ind)) +
  geom_bar(position = "fill") +
  scale_y_continuous(labels = scales::percent) + # Convert y-axis to percent
  labs(title = "Proportion of PTSD by VCUG Indicator Group",
       x = "VCUG Indicator Group",
       y = "Proportion") +
  scale_fill_brewer(palette = "Pastel1") +
  theme_minimal()

# Bar chart of OCD by VCUG indicator, proportional
# Create a bar chart with proportions
ggplot(diagnoses, aes(x = vcug_indicator, fill = ocd_ind)) +
  geom_bar(position = "fill") +
  scale_y_continuous(labels = scales::percent) + # Convert y-axis to percent
  labs(title = "Proportion of OCD by VCUG Indicator Group",
       x = "VCUG Indicator Group",
       y = "Proportion") +
  scale_fill_brewer(palette = "Pastel1") +
  theme_minimal()

# Bar chart of misophonia by VCUG indicator, proportional
# Create a bar chart with proportions
ggplot(diagnoses, aes(x = vcug_indicator, fill = misophonia_ind)) +
  geom_bar(position = "fill") +
  scale_y_continuous(labels = scales::percent) + # Convert y-axis to percent
  labs(title = "Proportion of misophonia by VCUG Indicator Group",
       x = "VCUG Indicator Group",
       y = "Proportion") +
  scale_fill_brewer(palette = "Pastel1") +
  theme_minimal()

# Bar chart of PGAD by VCUG indicator, proportional
# Create a bar chart with proportions
ggplot(diagnoses, aes(x = vcug_indicator, fill = pgad_ind)) +
  geom_bar(position = "fill") +
  scale_y_continuous(labels = scales::percent) + # Convert y-axis to percent
  labs(title = "Proportion of PGAD by VCUG Indicator Group",
       x = "VCUG Indicator Group",
       y = "Proportion") +
  scale_fill_brewer(palette = "Pastel1") +
  theme_minimal()

# Bar chart of HPF by VCUG indicator, proportional
# Create a bar chart with proportions
ggplot(diagnoses, aes(x = vcug_indicator, fill = hpf_ind)) +
  geom_bar(position = "fill") +
  scale_y_continuous(labels = scales::percent) + # Convert y-axis to percent
  labs(title = "Proportion of HPF by VCUG Indicator Group",
       x = "VCUG Indicator Group",
       y = "Proportion") +
  scale_fill_brewer(palette = "Pastel1") +
  theme_minimal()
```

**Takeaways:**

-   VCUG group returned a larger proportion of diagnoses or supposed diagnoses in every single category.

### Data Analysis - Utilization of necessary and preventive healthcare services

Create the necessary tables for this analysis.

```{r}
# Create new tables with selected columns
preventive_care_both <- t %>%
  select(vcug_indicator, sex_at_birth, physician_care, urologist_care)

# Create new table and filter out branching logic, females only
preventive_care_female <- t %>%
  select(vcug_indicator, sex_at_birth, gyn_care, pap_smear_ind)
preventive_care_female <- preventive_care_female %>%
  filter(sex_at_birth != "male")


```

#### *Do you see a physician for routine preventive care and/or physicals?*

```{r}
# CHANGE 1 2 3 TO FACTORS FOR ALL!

# Proportional bar chart of physician care willingness by vcug group
ggplot(preventive_care_both, aes(x = physician_care, fill = vcug_indicator)) +
  geom_bar(position = "fill") +
  scale_y_continuous(labels = scales::percent) +  # Convert y-axis to percent
  labs(title = "Proportion of Physician Care by VCUG Indicator",
       x = "Physician Care",
       y = "Proportion") +
  scale_fill_brewer(palette = "Set1") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x labels if they are long
```

#### *Do you see a gynecologist for routine preventive care (well-woman visits)?*

#### *Have you ever received a pap smear as part of preventive gynecological care?*

#### *Have you ever seen a urologist?*

## Results {#sec-results}

Describe your results and include relevant tables, plots, and code/comments used to obtain them. You may refer to the @sec-methods as needed. End with a brief conclusion of your findings related to the question you set out to address. You can include references if you'd like, but this is not required.

## Conclusion

This the conclusion. The @sec-results can be invoked if you'd like.
