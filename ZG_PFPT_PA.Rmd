---
title: "Physical Activity Level and Performance of Pelvic Floor Muscle Exercises"
author: "Zoe Gan"
output: 
  html_document:
    toc: true
    toc_float: true
    theme: paper 
    highlight: tango
---


***

### Overview
Pelvic floor muscle (PFM) exercises are a non-invasive and effective treatment option for female pelvic floor disorders, but patient adherence is often poor, and predictors of adherence are limited. Our objective is to evaluate the relationship between physical activity level in women and performance of PFM exercises.


### Introduction 
Pelvic floor muscle (PFM) exercises are an effective treatment for a variety of pelvic floor disorders (PFDs) in women, including urinary incontinence (UI), fecal incontinence, and symptomatic pelvic organ prolapse. They are often recommended by clinicians as an adjunct to medication in the case of overactive bladder or a non-invasive treatment option prior to considering surgery for stress UI. They may be done either at home or through formal pelvic floor physical therapy (PFPT) and are often known as Kegel exercises. However, compliance is poor, and the completion rate for women prescribed PFPT for PFDs has been cited at less than 50%(1). Poor compliance with PFM exercises may lead to missed opportunities for clinical improvement, which may ultimately subject patients to side effects from increased medication dosages or morbidity from surgical procedures.

Adherence to PFPT is an interdisciplinary issue and may be affected by several factors. Women recommended PFPT for treatment of UI most commonly cite boredom and forgetting do exercises as reasons for low adherence to PFPT(2). In a diverse, urban population of women prescribed PFPT, Hispanic women were less likely to initiate PFPT (3); age and nationality may also affect PFPT completion(1). These studies suggest that psychologic, cultural, and socioeconomic factors may play a role in performing PFPT. Given that enhanced patient counseling alone was not found to improve patient attendance at PFPT(4), there is a need to better understand the relationship between factors underlying non-adherence in order to design appropriate interventions. Physical activity has not previously been explored in this context.

Physical activity may influence performance of PFM exercises. Low baseline levels of physical activity have been associated with poor adherence to outpatient musculoskeletal physiotherapy(5). Patients with lower athletic identity, or identification with the athlete role, were shown to have lower participation in rehabilitation exercises on high-stress days after anterior cruciate ligament reconstruction(6). However, the relationship between physical activity and performance of PFM exercises specifically has not been explored. We explore the relationship between physical activity and performance of PFM exercises, hypothesizing that women who have higher levels of baseline physical activity perform PFM exercises more frequently than less active women.



### Methods
Women administered a cross-sectional survey through Research Match, a national online volunteer registry, were stratified into low, moderate, and high activity categories based on the International Physical Activity Questionnaire (IPAQ) Short Form. Reasons for starting Kegels or PFM exercises and sources of education about these exercises were described for the cohort. The primary outcome was the self-reported frequency of performing Kegels or PFM exercises compared between IPAQ groups. Secondary outcomes included whether women had previously heard of Kegel or PFM exercises and reasons for not performing these exercises more. 

Descriptive statistics were used to compare the following characteristics between women who reported performing PFM exercises at least a few times a week or more and women who did not: age, BMI, education level, race, ethnicity, smoking history, insurance status, self-reported general health, history of sexual activity, prior vaginal delivery, comprehensive urinary symptoms assessed by the Lower Urinary Tract Research Network-Symptom Index, LURN-SI 29, the incontinence subset of the LURN SI-29 for incontinence symptoms only, and physical activity level. Univariate and multivariable logistic regression were used to assess the impact of the demographic, urinary, and physical activity characteristics on performing PFM exercises several times a month or more. P<0.05 was considered significant. 

#### Importing Packages 
```{r}
#install.packages("tidyverse")
#install.packages("dplyr")
#install.packages("ggplot2")
#install.packages("modelsummary")
#install.packages("viridis")
#install.packages("expss")
#install.packages("tableone")
#install.packages("labelled")
#install.packages("gtsummary")
#install.packages("webshot2")
#install.packages("MASS")
```
#### Loading Packages
```{r}
library(tidyverse) 
library(ggplot2)
library(viridis)
library(modelsummary)
library(expss)
library(tableone)
library(labelled)
library(gtsummary)
library(webshot2)
library(dplyr)
```
#### Reading in data
```{r}
bladderhealth.df <- read.csv("PennBladderHealthStu_DATA_2022-09-23_1043.csv")

#Remove email addresses
bladderhealth.df <- select(bladderhealth.df, -email) #1755 observations

```
#### Cleaning data

##### First assess gender distribution
```{r}
#Apply labels to gender categories
bladderhealth.df <- bladderhealth.df %>%
  mutate(demo_gender = factor(demo_gender, levels = c(1, 2, 3, 4, 5, 6, 7, 8), labels = c("Female", "Male", "Trans Female", "Trans Male", "Genderqueer", "Gender nonconforming", "Other", "Decline to Answer")))
table(bladderhealth.df$demo_gender) 

#For simplicity, will exclude all responses that are not "female" given unclear anatomy of subjects who are trans, genderqueer, or gender nonconforming.
bladderhealth.df <- bladderhealth.df %>%
  filter(demo_gender == "Female") #1720 observations

```

##### Plan to evaluate the following variables to see if they predict doing PFM exercises (univariate and multivariable models):

age (demo_age), bmi (bmi, NEED TO CREATE), gender (demo_gender), education level (demo_edu), race (demo_race), ethnicity (demo_hisp), smoking hx (demo_cig), insurance (demo_insurance), general health (health_gen), vaginal deliveries (repro_children), sexually active (sex_active), LURN-SI 29 score (lurnsi29, NEED TO CREATE), physical activity level (ipaq, NEED TO CREATE)

3 variables need to be created: bmi, lurnsi29, and ipaq. Will create ipaq variable first for comparing questionnaire item answers between physical activity categories, then create bmi and lurnsi29 variables for the linear regression analyses.

##### Format data to calculate IPAQ score (ipaq)

Will first evaluate all time variables. These are individual variables for minutes, hours, and days for each level of activity (low, moderate, and high) that will be used to calculate IPAQ score and subsequently determine IPAQ category (low, moderate, and high physical activity level). Before using these for the IPAQ score calculation, need to ensure they are the proper class and don't have inaccurate outlying values (for example, >7 days of physical activity entered per week). IPAQ scoring guidelines also recommend a 15 hour per day cutoff for physical activity (and recoding such values to minutes instead, as they are assumed to have been erroneously entered in the "hours" category) and recoding any activity minute entries <10 minutes to 0 minutes and >180 minutes to 180 minutes (except for sitting time). Therefore, data cleaning is required before using the time variables for IPAQ score calculation.

```{r}

#Check class of time variables
class(bladderhealth.df$pa_66a_days)

#Convert time variables from character to numeric
cols <- c("pa_66a_days", "pa_66b_hours", "pa_66b_minutes", "pa_67a_days", "pa_67b_hours", "pa_67b_minutes", "pa_68a_days", "pa_68b_hours", "pa_68b_minutes", "pa_69_hours", "pa_69_minutes")
suppressWarnings(bladderhealth.df[cols] <- sapply(bladderhealth.df[cols], as.numeric))
#Initially received a warning that NAs were introduced by coercion. This is ok for our purposes, so the warning has been suppressed.

#Confirm all time variables are now numeric. 
sapply(bladderhealth.df[cols], class)

#Convert any NA values for time variables to 0
bladderhealth.df[cols][is.na(bladderhealth.df[cols])] <- 0 

#Check ranges of time variables to ensure appropriate values
sapply(bladderhealth.df[cols], range, na.rm = TRUE)
#Looks like all the days variables have outliers (can't have more than 7 days a week). 

#To visualize outliers for all IPAQ time variables, will create histograms. Need to create single column with time values using pivot longer, then use facet_wrap to separate histograms for individual variables.
bladderhealth_timevals.df <- bladderhealth.df %>% pivot_longer(all_of(cols), names_to = "time_var", values_to = "time_num")
ggplot(bladderhealth_timevals.df, aes(x = time_num)) + geom_histogram(binwidth = 1) + facet_wrap(~time_var, scales = "free")
```

##### Commentary on observed outliers, taking into account recommendations on data cleaning from the IPAQ scoring manual:

Can't have more than 7 days per week. Not sure whether to change these numbers to hours/minutes per day/week, so going to drop these values.
pa_66a_days appears to have single value over 7, 30. 
pa_67a_days appears to have single value over 7, 60+
pa_68a_days appears to have a few values over 7, up to 15. 

Can't do an activity for most hours of the day (15h cutoff). Will convert these values to minutes.
pa_66b_hours appears to have several values 20 or higher, up to 60.
pa_67b_hours appears to have several values 15 or higher, up to 45.
pa_68b_hours appears to have several values 15 or higher, up to 60.
pa_69_hours appears to have several values 15 or higher, up to nearly 300.

Anything over 180 minutes will get recoded to 180 min. (Does not apply to pa_69_minutes, sitting time.)
pa_66b_minutes doesn't have anything over 180 min.
pa_67b_minutes has some values over 180 min.
pa_68b_minutes has some values over 180 min.

##### Continue formatting data to calculate IPAQ score
```{r}
#Create new variable "exclude" to label subjects to exclude based on outlying day values (more than 7 days a week).
bladderhealth_clean.df <- bladderhealth.df %>% mutate(exclude = ifelse(pa_66a_days > 7 | pa_67a_days > 7 | pa_68a_days > 7, 1, 0))
table(bladderhealth_clean.df$exclude) #seven 1's to exclude, rest are 0s, no NAs
bladderhealth_clean.df <- bladderhealth_clean.df %>% filter(exclude == 0)

#Create data frame with outlying hour values to see if these subjects reported anything for minutes. 
bladderhealth_outliers.df <- bladderhealth_clean.df %>% filter(pa_66b_hours >= 15 | pa_67b_hours >= 15 | pa_68b_hours >= 15 | pa_69_hours >= 15) %>% select("pa_66b_hours", "pa_66b_minutes", "pa_67b_hours", "pa_67b_minutes", "pa_68b_hours", "pa_68b_minutes", "pa_69_hours", "pa_69_minutes")
#Looking at data frame, will need to combine hours and minutes for these outlying values.

#Switch outlying hour values to minutes (will use cutoff of 15 based on IPAQ data cleaning recs), i.e. if hours entry is 15 or higher, change this to minutes (add to anything existing in minutes column) and change original outlying hour entries to 0. 
bladderhealth_clean.df <- bladderhealth_clean.df %>% 
  mutate(pa_66b_minutes = ifelse(pa_66b_hours >= 15, pa_66b_hours + pa_66b_minutes, pa_66b_minutes)) %>% 
  mutate(pa_66b_hours = ifelse(pa_66b_hours >= 15, 0, pa_66b_hours)) %>% 
  mutate(pa_67b_minutes = ifelse(pa_67b_hours >= 15, pa_67b_hours + pa_67b_minutes, pa_67b_minutes)) %>% 
  mutate(pa_67b_hours = ifelse(pa_67b_hours >= 15, 0, pa_67b_hours)) %>%   
  mutate(pa_68b_minutes = ifelse(pa_68b_hours >= 15, pa_68b_hours + pa_68b_minutes, pa_68b_minutes)) %>% 
  mutate(pa_68b_hours = ifelse(pa_68b_hours >= 15, 0, pa_68b_hours)) %>%
  mutate(pa_69_minutes = ifelse(pa_69_hours >= 15, pa_69_hours + pa_69_minutes, pa_69_minutes)) %>% 
  mutate(pa_69_hours = ifelse(pa_69_hours >= 15, 0, pa_69_hours))

#Check one of the hour variables to confirm no remaining hour values >= 15; ok.
bladderhealth_clean.df %>% count(pa_67b_hours >= 15)

#Recode any time <10 min to 0 (except for question about sitting time, pa_69)
bladderhealth_clean.df <- bladderhealth_clean.df %>% 
  mutate(pa_66b_minutes = ifelse(pa_66b_minutes < 10, 0, pa_66b_minutes)) %>% 
  mutate(pa_67b_minutes = ifelse(pa_67b_minutes < 10, 0, pa_67b_minutes)) %>% 
  mutate(pa_68b_minutes = ifelse(pa_68b_minutes < 10, 0, pa_68b_minutes))  

#Recode any total time >180 min to 180 min (except for sitting pa_69)
bladderhealth_clean.df <- bladderhealth_clean.df %>% 
  mutate(pa_66b_minutes = ifelse(pa_66b_minutes > 180, 180, pa_66b_minutes)) %>% 
  mutate(pa_67b_minutes = ifelse(pa_67b_minutes > 180, 180, pa_67b_minutes)) %>% 
  mutate(pa_68b_minutes = ifelse(pa_68b_minutes > 180, 180, pa_68b_minutes))  

#Create variables for total minutes per day for each intensity category and walking. 
bladderhealth_clean.df <- bladderhealth_clean.df %>% 
  mutate(minutes_day_66 = (pa_66b_hours*60) + pa_66b_minutes) %>%
  mutate(minutes_day_67 = (pa_67b_hours*60) + pa_67b_minutes) %>%
  mutate(minutes_day_68 = (pa_68b_hours*60) + pa_68b_minutes) %>%
  mutate(minutes_day_69 = (pa_69_hours*60) + pa_69_minutes) 

#Check ranges of total minutes per day variables to ensure appropriate values.
timecols <- c("minutes_day_66", "minutes_day_67", "minutes_day_68", "minutes_day_69")
sapply(bladderhealth_clean.df[timecols], range) #Confirmed no activity variables have time over 960 min/day (would otherwise have to drop subjects with outlying values per IPAQ data cleaning recs). 

#Calculate total MET-min/week (metabolic equivalents, as part of IPAQ scoring) for each subject.
bladderhealth_clean.df <- bladderhealth_clean.df %>% 
  mutate(MET_min_week = 8*pa_66a_days*minutes_day_66 + 4*pa_67a_days*minutes_day_67 + 3.3*pa_68a_days*minutes_day_68)

#Calculate IPAQ score based on activity categories.
#High: at least 7 days of any activity AND at least 3,000 MET-min/week, OR at least 3 days of vigorous activity AND at least 1500 MET-minutes/week. 
#Mod: at least 3 days of vigorous activity AND at least 20 minutes per day, OR at least 5 days of moderate-intensity activity and/or walking of at least 30 minutes per day, OR at least 5 days of any activity AND at least 600 MET-min/week.
#Low: everyone else not meeting above criteria

bladderhealth_clean.df <- bladderhealth_clean.df %>%
  mutate(ipaq = ifelse(pa_66a_days + pa_67a_days + pa_68a_days >=7 & MET_min_week >= 3000, "3",
                       ifelse(pa_66a_days >= 3 & MET_min_week >= 1500, "3",
                              ifelse(pa_66a_days >=3 & minutes_day_66 >= 20, "2",
                                     ifelse(pa_67a_days + pa_68a_days >=5 & minutes_day_67 + minutes_day_68 >= 30, "2",
                                            ifelse(pa_66a_days + pa_67a_days + pa_68a_days >= 5 & MET_min_week >= 600, "2", "1"
                                            ))))))

#Look at distribution of IPAQ scores:
table(bladderhealth_clean.df$ipaq) 
#450 high (26.2%), 451 moderate (26.2%), 812 low (47.2%). 

#Check class of new IPAQ variable
class(bladderhealth_clean.df$ipaq) #character, convert to numeric
bladderhealth_clean.df$ipaq <- as.numeric(bladderhealth_clean.df$ipaq) 
class(bladderhealth_clean.df$ipaq) #numeric, will need to convert to factor (will do this later in bulk while cleaning other variables)

```
##### Clean data for analysis of question variables of interest (kegel_86, kegel_87, kegel_89, kegel_89b, kegel_91, kegel_92) across IPAQ groups
```{r}
#Convert IPAQ and question variables of interest to factors.
bladderhealth_clean.df <- bladderhealth_clean.df %>% 
  mutate(ipaq = factor(ipaq, levels = c(1, 2, 3), labels = c("Low", "Moderate", "High"))) %>%
  mutate(kegel_86 = factor(kegel_86, order = TRUE, levels = c(1, 2, 3), labels = c("Yes, I know what they are", "Yes, I've heard of them but I don't know what they are", "No, I have not heard of them and I do not know what they are"))) %>% 
  mutate(kegel_87 = factor(kegel_87, order = TRUE, levels = c(1, 2, 3), labels = c("Yes, I know what they are", "Yes, I've heard of them but I don't know what they are", "No, I have not heard of them and I do not know what they are"))) %>% 
  mutate(kegel_89 = factor(kegel_89, order = TRUE, levels = c(1, 2, 3, 4, 5, 6), labels = c("No, I never did these", "I used do them but stopped", "I do them occasionally when I think of it", "I do them several times a month", "I do them several times a week", "I do them daily"))) %>% 
  mutate(kegel_89b = factor(kegel_89b, order = TRUE, levels = c(1, 2, 3, 4, 5, 6), labels = c("I don't need to", "They're too difficult", "They take too much time", "They don't help enough", "I'm too lazy", "Other"))) %>%
  mutate(kegel_89b_specific = ifelse(kegel_89b == "Other", NA, kegel_89b)) %>%
  mutate(kegel_89b_specific = factor(kegel_89b_specific, order = TRUE, levels = c(1, 2, 3, 4, 5), labels = c("I don't need to", "They're too difficult", "They take too much time", "They don't help enough", "I'm too lazy")))

#Drop NA values for questions of interest. Will create separate data frames for each variable to avoid losing data from other questions not being answered. 
bladderhealth_kegel_86.df <- bladderhealth_clean.df %>% drop_na(kegel_86) #1720 to 1699 obs
bladderhealth_kegel_87.df <- bladderhealth_clean.df %>% drop_na(kegel_87) #1720 to 1697 obs
bladderhealth_kegel_89.df <- bladderhealth_clean.df %>% drop_na(kegel_89) #1720 to 1700 obs
bladderhealth_kegel_89b.df <- bladderhealth_clean.df %>% drop_na(kegel_89b) #1720 to 1036 obs
bladderhealth_kegel_89b_specific.df <- bladderhealth_clean.df %>% drop_na(kegel_89b_specific) #1720 to 631 obs
#Will also create data frame for missing values from both kegel_86 and kegel_87, since part of the analysis will include these questions together.
bladderhealth_kegel_86_87.df <- bladderhealth_clean.df %>% drop_na(kegel_86, kegel_87) #1720 to 1697 obs

#Will create data frames with checkbox questions (kegel_91 and kegel_92) as individual variables using pivot_longer, then factorize new variables.

bladderhealth_kegel_91.df <- bladderhealth_clean.df %>% 
  pivot_longer(c(kegel_91___1:kegel_91___10), names_to = "kegel_91", values_to = "kegel_91_present", values_drop_na = TRUE) %>% 
  filter(kegel_91_present != 0) %>% #include only entries where boxes were checked (i.e. "1" not "0")
  mutate(kegel_91 = factor(kegel_91, levels = c("kegel_91___1", "kegel_91___2", "kegel_91___3", "kegel_91___4", "kegel_91___5", "kegel_91___6", "kegel_91___7", "kegel_91___8", "kegel_91___9", "kegel_91___10"), labels = c("I was told to start after childbirth", "To treat my urine leakage/bladder leaks", "To treat urinary urgency", "To treat my bowel problem", "To improve sex", "To prevent getting a problem", "Because my doctor, nurse or therapist suggested I do them", "Because a friend or family member suggested me to do them", "Because a magazine or website suggested me to do them", "Other")))
  
bladderhealth_kegel_92.df <- bladderhealth_clean.df %>% 
  pivot_longer(c(kegel_92___1:kegel_92___7), names_to = "kegel_92", values_to = "kegel_92_present", values_drop_na = TRUE) %>% 
  filter(kegel_92_present != 0) %>% #include only entries where boxes were checked (i.e. "1" not "0")
  mutate(kegel_92 = factor(kegel_92, levels = c("kegel_92___1", "kegel_92___2", "kegel_92___3", "kegel_92___4", "kegel_92___5", "kegel_92___6", "kegel_92___7"), labels = c("A book/magazine", "A pamphlet or brochure", "An online website", "A doctor, nurse or therapist", "A fitness instructor", "A friend or family member", "Other")))

```
##### Format data to calculate LURN SI-29 score (lurnsi29)
```{r}

#Convert LURN SI-29 item responses from 1-5 (answer categories in ResearchMatch survey) to 0-4 (LURN scoring), excluding question additional_56 (already 1/0 due to yes/no format in RedCap). Subset the original data frame to specify the LURN SI-29 items that need to be converted, convert them using apply(), then bind the remaining items in the original data frame to the new converted columns using cbind(). 
lurnvars_convert <- c("casus_33", "casus_34", "casus_35", "casus_36", "casus_37", "casus_38", "pain_39", "pain_40", "pain_41", "pain_42", "voidingdiff_43", "voidingdiff_44", "voidingdiff_45", "voidingdiff_46", "voidingdiff_47", "urgency_48", "urgency_49", "urgency_50", "nocturia_51", "nocturia_52", "additional_53", "additional_54", "additional_55", "additional_57", "additional_58", "additional_59", "additional_60")
bladderhealth_clean.df <- cbind(bladderhealth_clean.df[,!names(bladderhealth_clean.df) %in% lurnvars_convert], apply(bladderhealth_clean.df[lurnvars_convert], 2, function(x) x - 1))

#For any LURN SI-29 item with a missing value (NA), convert these values to 0 for total LURN SI-29 score calculation purposes (including additional_56).
lurnvars <- c("casus_33", "casus_34", "casus_35", "casus_36", "casus_37", "casus_38", "pain_39", "pain_40", "pain_41", "pain_42", "voidingdiff_43", "voidingdiff_44", "voidingdiff_45", "voidingdiff_46", "voidingdiff_47", "urgency_48", "urgency_49", "urgency_50", "nocturia_51", "nocturia_52", "additional_53", "additional_54", "additional_55", "additional_56", "additional_57", "additional_58", "additional_59", "additional_60")
bladderhealth_clean.df[lurnvars][is.na(bladderhealth_clean.df[lurnvars])] <- 0 

```
##### Assess data needed to calculate BMI (bmi)
```{r}

#Assess height variables for cleaning later
class(bladderhealth_clean.df$demo_height) #Integer
class(bladderhealth_clean.df$demo_height_cm) #Character
table(bladderhealth_clean.df$demo_height) #No NA values. Answers range from 6-34 (numbered categories corresponding to specific heights in data dictionary).
table(bladderhealth_clean.df$demo_height_cm) #Some of these values are not in the proper numeric cm format and will need to be recoded. There are no true NA values, but 1680 subjects have a blank string as their entry.
#Identify the subjects with demo_height_cm values
bladderhealth_clean.df %>% filter(demo_height_cm != "") %>% select(record_id, demo_height, demo_height_cm) 
#For all subjects with both demo_height AND demo_height_cm values, will drop demo_height_cm and just use demo_height. Now identify subjects with ONLY demo_height_cm values - these values will need to be converted over to demo_height.
bladderhealth_clean.df %>% filter(demo_height_cm != "" & is.na(demo_height)) %>% select(record_id, demo_height, demo_height_cm) 
#The following entries in demo_height_cm need to be converted to demo_height: 1.68, 62, 158, 164, 170, 5'8' (record_ID 860), 5' 2' (record_id 1367), 5'1' (record_id 1395).
#After converting these, can drop all remaining demo_height_cm values. 
#Finally, will convert the demo_height categories (numbered 6-34) to actual inches.

#Assess weight variables for cleaning later
class(bladderhealth_clean.df$demo_weight) #Numeric
class(bladderhealth_clean.df$demo_weight_kg) #Character, will need to convert to numeric before converting to lbs later (multiplying by 2.2).
table(bladderhealth_clean.df$demo_weight) #No NA or blank values. Range 25-390. 25 probably meant to be kg so will convert to lbs in code chunk below. How tall is this person?
bladderhealth_clean.df %>% filter(demo_weight == 25) %>% select(demo_weight, demo_height)
table(bladderhealth_clean.df$demo_weight_kg) #5'3" (per height category "18" in data dictionary), so 55 lbs still seems really low. Will exclude this value when cleaning up data later. No true NA values, but 1687 entries with blank values.
#Identify all entries with both lbs AND kg. For these entries, will use lbs entry and drop kg entry.
bladderhealth_clean.df %>% select(record_id, demo_weight, demo_weight_kg) %>% filter(demo_weight_kg != "") 
#Identify all entries with kg entry ONLY, but no lbs entry. For these entries, plan to convert kg to lbs, then drop the kg values.
bladderhealth_clean.df %>% select(record_id, demo_weight, demo_weight_kg) %>% filter(demo_weight_kg != "" & is.na(demo_weight)) 
#record_id 1698 has 105 recorded. Is this lbs or kg? Will check height
bladderhealth_clean.df %>% filter(record_id == 1698) %>% select(demo_height_cm, demo_weight_kg)
#Someone who is 5'5" could plausibly be 230 lbs, more likely than 105 lbs, so will keep 105 as kg.

```
##### Check variable to use for vaginal deliveries
```{r}
table(bladderhealth_clean.df$repro_children) #answers include "no", "none", and "None". Will need to convert these to 0. 
```
##### Create new data frame for linear regression analyses 
Put all the code together to clean up height & weight.
```{r}
suppressWarnings({
  bladderhealth_mv.df <- bladderhealth_clean.df %>% 
mutate(demo_height = ifelse(demo_height_cm == "1.68", 21, demo_height)) %>%
  mutate(demo_height_cm = ifelse(demo_height_cm == "1.68", NA, demo_height_cm)) %>%
  mutate(demo_height = ifelse(demo_height_cm == "62", 17, demo_height)) %>%
  mutate(demo_height_cm = ifelse(demo_height_cm == "62", NA, demo_height_cm)) %>%
  mutate(demo_height = ifelse(demo_height_cm == "158", 17, demo_height)) %>%
  mutate(demo_height_cm = ifelse(demo_height_cm == "158", NA, demo_height_cm)) %>%
  mutate(demo_height = ifelse(demo_height_cm == "164", 20, demo_height)) %>%
  mutate(demo_height_cm = ifelse(demo_height_cm == "164", NA, demo_height_cm)) %>%
  mutate(demo_height = ifelse(demo_height_cm == "170", 20, demo_height)) %>%
  mutate(demo_height_cm = ifelse(demo_height_cm == "170", NA, demo_height_cm)) %>%
  mutate(demo_height = ifelse(record_id == "860", 23, demo_height)) %>%
  mutate(demo_height_cm = ifelse(record_id == "860", NA, demo_height_cm)) %>%
  mutate(demo_height = ifelse(record_id == "1367", 17, demo_height)) %>%
  mutate(demo_height_cm = ifelse(record_id == "1367", NA, demo_height_cm)) %>%
    mutate(demo_height = ifelse(record_id == "1395", 16, demo_height)) %>%
  mutate(demo_height_cm = ifelse(record_id == "1395", NA, demo_height_cm)) %>%
mutate(demo_height = ifelse(!is.na(demo_height_cm) & is.na(demo_height), 16, demo_height)) %>%
mutate(demo_height_cm = ifelse(!is.na(demo_height_cm) & !is.na(demo_height), NA, demo_height_cm)) %>%
mutate(demo_height = ifelse(demo_height == "6", 52, ifelse(demo_height == "8", 54, ifelse(demo_height == "11", 57, ifelse(demo_height == "12", 58, ifelse(demo_height == "13", 59, ifelse(demo_height == "15", 60, ifelse(demo_height == "16", 61, ifelse(demo_height == "17", 62, ifelse(demo_height == "18", 63, ifelse(demo_height == "19", 64, ifelse(demo_height == "20", 65, ifelse(demo_height == "21", 66, ifelse(demo_height == "22", 67, ifelse(demo_height == "23", 68, ifelse(demo_height == "24", 69, ifelse(demo_height == "25", 70, ifelse(demo_height == "26", 71, ifelse(demo_height == "28", 72, ifelse(demo_height == "29", 73, ifelse(demo_height == "34", 78, NA))))))))))))))))))))) %>%
  mutate(demo_weight = ifelse(demo_weight == "25", NA, demo_weight)) %>%
  mutate(demo_weight_kg = as.numeric(demo_weight_kg)) %>%
  mutate(demo_weight = ifelse(is.na(demo_weight) & (!is.na(demo_weight_kg)), demo_weight_kg*2.2, demo_weight)) %>%
  mutate(demo_weight_kg = ifelse(!is.na(demo_weight_kg), NA, demo_weight_kg))
  }) #Initial warning that NAs induced by coercion. This is ok for our purposes, so warnings have been suppressed.

#Recheck height & weight variables
table(bladderhealth_mv.df$demo_height) #range 52-78 inches, appears reasonable
table(bladderhealth_mv.df$demo_height_cm) #no values, as expected
table(bladderhealth_mv.df$demo_weight) #range 90-390 lbs, appears reasonable
table(bladderhealth_mv.df$demo_weight_kg) #no values, as expected

```
##### Clean up/create other variables for linear regression analyses 

Of note, will calculate LURN SI-29 score (lurnsi29) which is the sum of individual symptom domain scores (pain, voiding difficulty, incontinence, etc.) from the LURN SI-29 questionnaire. Will also create a binary outcome variable (doing Kegels a few times a week or more) to use in the linear regression analyses.

```{r}
bladderhealth_mv.df <- bladderhealth_mv.df %>% rename(age = demo_age, height = demo_height, weight = demo_weight, edu = demo_edu, hisp = demo_hisp, sex_hx = repro_sex, cig_hx = demo_cig, cig_now = demo_cig_a, insurance = demo_insurance, vag_del = repro_children) %>%
  mutate(sex_hx = ifelse(sex_hx == "2", 0, 1)) %>%
  mutate(sex_hx = factor(sex_hx, levels = c(0, 1), labels = c("Never", "Yes"))) %>%
  mutate(edu = ifelse(edu == "1", 1, ifelse(edu == "2", 1, ifelse(edu == "3", 1, ifelse(edu == "4", 2, ifelse(edu == "5", 2, ifelse(edu == "6", 3, 4))))))) %>%
  mutate(edu = factor(edu, levels = c(1, 2, 3, 4), labels = c("High school or less", "Some college or associate's degree", "Bachelor's degree", "Masters/professional/doctorate degree"))) %>%
  mutate(race = ifelse(demo_race___1 == "1", 1, ifelse(demo_race___2 == "1", 2, ifelse(demo_race___3 == "1", 3, ifelse(demo_race___4 == "1", 3, ifelse(demo_race___5 == "1", 3, ifelse(demo_race___6 == "1", 3, ifelse(demo_race___7 == "1", 3, NA)))))))) %>%
  mutate(race = factor(race, levels = c(1, 2, 3), labels = c("White or Caucasian", "Black or African American", "Other"))) %>%
  mutate(hisp = factor(hisp, levels = c(0, 1), labels = c("Not Hispanic", "Hispanic"))) %>%
  mutate(cig_hx = factor(cig_hx, levels = c(0, 1), labels = c("Less than 100 cigarettes", "100 cigarettes or more"))) %>%
  mutate(cig_now = factor(cig_now, levels = c(0, 1), labels = c("No", "Yes"))) %>%
  mutate(insurance = ifelse(insurance == "1", 1, 0)) %>%
  mutate(insurance = factor(insurance, levels = c(0, 1), labels = c("Uninsured", "Insured"))) %>%
  mutate(health_gen = factor(health_gen, levels = c(1, 2, 3, 4, 5), labels = c("Excellent", "Very good", "Good", "Fair", "Poor"))) %>%
  mutate(vag_del = ifelse(vag_del == "0", 0, ifelse(vag_del == "no", 0, ifelse(vag_del == "none", 0, ifelse(vag_del == "None", 0, 1))))) %>%
  mutate(vag_del = factor(vag_del, levels = c(0, 1), labels = c("No", "Yes"))) %>%
  mutate(bmi = weight*703/(height^2)) %>%
  mutate(casus_total = select(., casus_33:casus_38) %>% rowSums()) %>% 
  mutate(pain_total = select(., pain_39:pain_42) %>% rowSums()) %>% 
  mutate(voidingdiff_total = select(., voidingdiff_43:voidingdiff_47) %>% rowSums()) %>%
  mutate(urgency_total = select(., urgency_48:urgency_50) %>% rowSums()) %>% 
  mutate(nocturia_total = select(., nocturia_51, nocturia_52) %>% rowSums()) %>% 
  mutate(additional_total = select(., additional_53:additional_60) %>% rowSums()) %>% 
  mutate(lurnsi29 = select(., casus_total:additional_total) %>% rowSums()) %>%
  mutate(kegel_89_binary = ifelse(kegel_89 == "I do them several times a month" | kegel_89 == "I do them several times a week" | kegel_89 == "I do them daily", 1, 0)) %>%
  mutate(kegel_89_binary = factor(kegel_89_binary, levels = c(0, 1), labels = c("Not doing Kegels", "Doing Kegels several times a month or more")))

#Check distribution of LURN SI-29 scores. Will need to convert to categorical/factor for linear regression analyses.
ggplot(bladderhealth_mv.df, aes(x = lurnsi29)) + geom_histogram(binwidth = 1) #Left-skewed bell curve
summary(bladderhealth_mv.df$lurnsi29) #Median 18
#Find tertiles of lurnsi29, then use these to create a categorical variable for lurnsi29 .
vTert = quantile(bladderhealth_mv.df$lurnsi29, c(0:3/3), na.rm = TRUE)
bladderhealth_mv.df$lurnsi29cat = with(bladderhealth_mv.df, 
               cut(lurnsi29, 
                   vTert, 
                   include.lowest = T, 
                   labels = c("Low", "Medium", "High")))
bladderhealth_mv.df <- bladderhealth_mv.df %>% apply_labels(lurnsi29cat = "LURN SI-29 score category") 
summary(bladderhealth_mv.df$lurnsi29cat) #Roughly 500-600 subjects in each category.

#Since Kegels are traditionally through to be used more for incontinence than other urinary symptoms, we will see later on if using an incontinence-only score rather than a comprehensive urinary symptom score will change results. 
#Therefore, check distribution of incontinence-only score (casus_total). Will need to convert to categorical/factor for multivariate analysis. 
ggplot(bladderhealth_mv.df, aes(x = casus_total)) + geom_histogram(binwidth = 1) #strong left skew, most values 0
summary(bladderhealth_mv.df$casus_total) #median 1
#Originally tried to find tertiles of casus_total -> "error in cut, breaks are not unique" likely because most values are 0. Will stratify by 0 and >0 instead to create a categorical variable for casus_total.
bladderhealth_mv.df <- bladderhealth_mv.df %>% mutate(casus_total_cat = ifelse(casus_total == 0, 0, 1)) %>%
  mutate(casus_total_cat = factor(casus_total_cat, levels = c(0, 1), labels = c("Absent", "Present")))
summary(bladderhealth_mv.df$casus_total_cat) #Roughly 600 in absent category, roughly 1000 in present category.

#Apply variable labels
var_label(bladderhealth_mv.df) <- list(age = "Age in years", bmi = "BMI", edu = "Highest education level", race = "Race", hisp = "Ethnicity", cig_hx = "Lifetime smoking history", cig_now = "Current smoking status", sex_hx = "History of sexual activity", health_gen = "Self-reported health", insurance = "Insurance status", vag_del = "Prior vaginal delivery", casus_total_cat = "Incontinence status", ipaq = "IPAQ activity category")
                    
#Look at distribution of primary outcome variable, kegel_89. 
table(bladderhealth_mv.df$kegel_89)
#Will stratify so that 1-3 is not doing Kegels regularly (never did them, used to but stopped, occasionally when I think of them) and 4-6 is doing Kegels regularly (several times/month, several times/week, daily)
#Look at distribution of primary outcome variable to use for linear regression, kegel_89_binary. 
table(bladderhealth_mv.df$kegel_89_binary)
#1476 not doing Kegels regularly, 224 doing them regularly.
              
```
### Results

See why people report doing PFM exercises (kegel_91) and how they learned about them (kegel_92). Will look at the distribution of answers to these questionnaire items.

##### kegel_91: Why did you start doing Kegels or pelvic exercises? Check all that apply.

```{r}

#Look at distribution of answers for kegel_91
table(bladderhealth_kegel_91.df$kegel_91)
#Convert these numbers to percentages of total women surveyed (1748)
list <- table(bladderhealth_kegel_91.df$kegel_91)
lapply(list, function(x) x/1748*100)

#kegel_91___1: "I was told to start after childbirth": 314, 18.0%
#kegel_92___2: "To treat my urine leakage/bladder leaks": 230, 13.2%
#kegel_91___3: "To treat urinary urgency": 87, 5.0%
#kegel_91___4 = "To treat my bowel problem": 25, 1.4%
#kegel_91___5 = "To improve sex": 452, 25.9%
#kegel_91___6 = "To prevent getting a problem": 311, 17.8%
#kegel_91___7 = "Because my doctor, nurse or therapist suggested I do them": 266, 15.2%
#kegel_91___8 = "Because a friend or family member suggested me to do them": 217, 12.4%
#kegel_91___9 = "Because a magazine or website suggested me to do them": 299, 17.1%
#kegel_91___10 = "Other": 88, 5.0%

#Bar plot to visualize distributions of answers to kegel_91
ggplot(bladderhealth_kegel_91.df, aes(x = reorder(kegel_91, kegel_91, function(x) length(x)))) +
  geom_bar(fill="#f68060", alpha= 1, width=.4) + 
  ggtitle("Why did you start doing Kegels or pelvic exercises?") +
  xlab("") +
  ylab("Number of responses") +
  theme(plot.title = element_text(hjust = 2, color = "black", size = 12)) + 
  theme(axis.title.x = element_text(color = "black", size = 10)) + 
  theme(axis.title.y = element_text(color = "black", size = 10)) +
  theme(legend.title = element_blank()) + 
  coord_flip()

#Save graph.
ggsave("Supplemental Fig 1 - Reasons for Kegels.tiff", units="in", width=6, height=4, dpi=300)

```

The top 3 reasons given for doing PFM exercises were to improve sex (25.9%), to prevent getting a problem (17.8%), and being instructed to start doing them after childbirth (18.0%). 

##### kegel_92: How did you learn about Kegels or pelvic muscle exercises?  Check all that apply.
```{r}

#Look at distribution of answers for kegel_92
table(bladderhealth_kegel_92.df$kegel_92)
#Convert these numbers to percentages of total women surveyed (1748)
list <- table(bladderhealth_kegel_92.df$kegel_92)
lapply(list, function(x) x/1748*100)

#kegel_92___1 = "A book/magazine": 504, 28.8%
#kegel_92___2 = "A pamphlet or brochure": 105, 6.0%
#kegel_92___3 = "An online website": 349, 20.0%
#kegel_92___4 = "A doctor, nurse or therapist": 608, 34.8%
#kegel_92___5 = "A fitness instructor": 104: 5.9%
#kegel_92___6 = "A friend or family member": 454, 26.0%
#kegel_92___7 = "Other": 169, 9.7%

#Bar plot to visualize distributions of answers to kegel_92
ggplot(bladderhealth_kegel_92.df, aes(x = reorder(kegel_92, kegel_92, function(x) length(x)))) +
  geom_bar(fill="#f68060", alpha= 1, width=.4) + 
  ggtitle("How did you learn about Kegels or pelvic muscle exercises?") +
  xlab("") +
  ylab("Number of responses") +
  theme(plot.title = element_text(hjust = -2, color = "black", size = 12)) + 
  theme(axis.title.x = element_text(color = "black", size = 10)) + 
  theme(axis.title.y = element_text(color = "black", size = 10)) +
  theme(legend.title = element_blank()) + 
  coord_flip()

#Save graph.
ggsave("Supplemental Fig 2 - Kegels by learning source.tiff", units="in", width=6, height=4, dpi=300)

```

The top 3 sources of information about PFM exercises were a doctor, nurse, or therapist (34.8%); a book or magazine (28.8%), and a friend or family member (26.0%). 

#### Primary outcome
Frequency of doing PFM exercises compared between IPAQ groups (i.e. responses to the following questionnaire item compared between IPAQ groups). Will look at distribution of answers, then compare distribution between IPAQ groups using the Kruskal-Wallis test.

##### kegel_89: Do you do Kegels or pelvic muscle exercises?
```{r}

#Evaluate the distribution of kegel_89 answers among the 3 IPAQ categories (high, moderate, low).
ggplot(bladderhealth_kegel_89.df, aes(fill = kegel_89, x = ipaq)) + geom_bar(position = "fill") + ggtitle("Do you do Kegels or pelvic muscle exercises?") +
xlab("Activity category") +
ylab("Percentage of respondents") +
theme(plot.title = element_text(color = "black", size = 12)) + 
theme(axis.title.x = element_text(color = "black", size = 10)) + 
theme(axis.title.y = element_text(color = "black", size = 10)) +
scale_x_discrete(labels = c("low" = "Low", "moderate" = "Moderate", "high" = "High")) + scale_y_continuous(labels = scales::percent) +
  theme(legend.title = element_blank())
```

Women in the high activity group appear to be more likely to do PFM exercises several times a month or more.
```{r}
#Save graph.
ggsave("Fig 1 - Kegels by IPAQ category.tiff", units="in", width=6, height=4, dpi=300)

#Get numbers for each category
table(bladderhealth_kegel_89.df$kegel_89, bladderhealth_kegel_89.df$ipaq)
#Get proportions for each category
prop.table(table(bladderhealth_kegel_89.df$kegel_89, bladderhealth_kegel_89.df$ipaq), 2)

#Kruskal-Wallis test for ipaq and pa_89:
kruskal.test(bladderhealth_kegel_89.df$kegel_89, bladderhealth_kegel_89.df$ipaq)
#The distribution of answers is significantly different between IPAQ categories (p = 0.002395). 

#For all groups, how many report doing PFMs several times a month or more?
bladderhealth_kegel_89.df %>% count(kegel_89 == "I do them several times a month" | kegel_89 == "I do them several times a week" | kegel_89 == "I do them daily") #224/1700*100 = 13.2%

#For each IPAQ group, how many report doing PFMs several times a month or more?
bladderhealth_kegel_89.df %>% group_by(ipaq) %>% count(kegel_89 == "I do them several times a month" | kegel_89 == "I do them several times a week" | kegel_89 == "I do them daily")
#Low = 96/(706+96)*100 = 12.0%
#Moderate = 48/(400+48)*100 = 10.7%
#High = 80/(370+80)*100 = 17.8%

#Confirm that when condensing outcome categories for doing PFM exercises "several times a month or more," categories are still significantly different among IPAQ groups. 
bladderhealth_kegel_89_condensed.df <- bladderhealth_kegel_89.df %>% mutate(kegel_89 = fct_collapse(kegel_89, "I do them several times a month or more" = c("I do them several times a month", "I do them several times a week", "I do them daily")))
kruskal.test(bladderhealth_kegel_89_condensed.df$kegel_89, bladderhealth_kegel_89_condensed.df$ipaq)
#Still significant, p = 0.002034.

```
#### Secondary outcomes
For each item, look at distribution of answers, then compare distribution between IPAQ groups using the Kruskal-Wallis test.

##### kegel_86: Have you ever heard of Kegel exercises?
##### kegel_87: Have you heard of pelvic exercises or pelvic floor muscle exercises?

```{r}
#How many women have heard of Kegels (kegel_86) or PFMs (kegel_87)? 
bladderhealth_kegel_86_87.df %>% count(kegel_86 == "Yes, I know what they are" | kegel_86 == "Yes, I've heard of them but I don't know what they are" | kegel_87 == "Yes, I know what they are" | kegel_87 == "Yes, I've heard of them but I don't know what they are") 
#1652 have heard of Kegels or PFMs, but may or may not know what they are. 1652/1697*100 = 97.3%

#How many women have heard of Kegels (kegel_86) or PFMs (kegel_87) AND know what they are?
bladderhealth_kegel_86_87.df %>% count(kegel_86 == "Yes, I know what they are" | kegel_87 == "Yes, I know what they are") 
#1519 have both heard of them and know what they are. 1519/1697*100 = 89.5%

#Are the responses to kegel_86 different between IPAQ groups?
kruskal.test(bladderhealth_kegel_86.df$kegel_86, bladderhealth_kegel_86.df$ipaq) #no, p = 0.5493

#Are the responses to kegel_87 different between IPAQ groups?
kruskal.test(bladderhealth_kegel_87.df$kegel_87, bladderhealth_kegel_87.df$ipaq) #yes, p = 0.006639 

#Will use proportional stacked bar plot to better visualize distribution for kegel_87 among IPAQ groups.
ggplot(bladderhealth_kegel_87.df, aes(fill = as.factor(kegel_87), x = ipaq)) + geom_bar(position = "fill") + ggtitle("Have you heard of pelvic exercises or pelvic floor muscle exercises?") +
xlab("Activity category") +
ylab("Percentage of respondents") +
theme(plot.title = element_text(color = "black", size = 12)) + 
theme(axis.title.x = element_text(color = "black", size = 10)) + 
theme(axis.title.y = element_text(color = "black", size = 10)) +
scale_x_discrete(labels = c("low" = "Low", "moderate" = "Moderate", "high" = "High")) + scale_y_continuous(labels = scales::percent) +
  theme(legend.title = element_blank())

#Save graph.
ggsave("Supplemental Fig 3 - Heard of Kegels by IPAQ category.tiff", units="in", width=6, height=4, dpi=300)
```

97.3% of women had heard of Kegels or PFM exercises, and 89.5% of women had both heard of them and knew what they were. Compared to women in the low and moderate physical activity groups, women in the high physical activity group were more likely to know what "PFM exercises" were, but not "Kegel exercises."

##### kegel_89b: Why don't you do Kegels or pelvic muscle exercises more? 
```{r}
table(bladderhealth_kegel_89b.df$kegel_89b) 
#Most women said other (405/1036, 39.1%), 2nd most said I'm too lazy (291/1036, 28.1%), then I don't need to (169/1036, 16.3%) and they don't help enough (134/1036, 12.9%). Very few said they were too difficult (20/1036, 1.9%) or take too much time (17/1036, 1.6%).

#Are the responses to kegel_89b different between IPAQ groups?
kruskal.test(bladderhealth_kegel_89b.df$kegel_89b, bladderhealth_kegel_89b.df$ipaq) #no, p = 0.1203.

#Excluding "other" as a reason for not doing Kegels, did the answers differ between IPAQ groups?
kruskal.test(bladderhealth_kegel_89b_specific.df$kegel_89b_specific, bladderhealth_kegel_89b_specific.df$ipaq) #yes, p = 0.02.

#Get numbers for each category
table(bladderhealth_kegel_89b_specific.df$kegel_89b_specific, bladderhealth_kegel_89b_specific.df$ipaq)
#Get proportions for each category
prop.table(table(bladderhealth_kegel_89b_specific.df$kegel_89b_specific, bladderhealth_kegel_89b_specific.df$ipaq), 2)

#Will use proportional stacked bar plot to better visualize distribution for kegel_89b_specific among IPAQ groups.
ggplot(bladderhealth_kegel_89b_specific.df, aes(fill = kegel_89b_specific, x = ipaq)) + geom_bar(position = "fill") + ggtitle("Why don't you do Kegels or pelvic muscle exercises more?") +
xlab("Activity category") +
ylab("Percentage of respondents") +
theme(plot.title = element_text(color = "black", size = 12)) + 
theme(axis.title.x = element_text(color = "black", size = 10)) + 
theme(axis.title.y = element_text(color = "black", size = 10)) +
scale_x_discrete(labels = c("low" = "Low", "moderate" = "Moderate", "high" = "High")) + scale_y_continuous(labels = scales::percent) +
  theme(legend.title = element_blank())

#Save graph.
ggsave("Fig 2 - Reasons for not doing Kegels by IPAQ category.tiff", units="in", width=6, height=4, dpi=300)

```

While the top reason given for not doing Kegels or PFM exercises more was "other" (39.1%), out of the remaining reasons, "I'm too lazy" (28.1%), "I don't need to (16.3%), and "they don't help enough" (12.9%) were the most common. Out of the women who gave specific reasons for not doing Kegels or PFM exercises more, women in the high activity group were less likely to report "I'm too lazy" (38.7%, vs. 51.2% and 47.6% in the moderate and low activity groups, respectively) and more likely to report "I don't need to" (33.5%, vs. 24.4% and 24.1% in the moderate and low activity groups, respectively). These differences were significant on the Kruskal-Wallis test (p = 0.02).

#### Baseline characteristics by outcome group
Create Table 1 comparing baseline characteristics between binary outcome groups (women who are not doing Kegels, vs. women doing Kegels several times a month or more).

```{r}                         

listVars_tbl_summ <- c("age", "bmi", "edu", "race", "hisp", "cig_hx", "insurance", "health_gen", "sex_hx", "vag_del", "lurnsi29cat", "casus_total_cat", "ipaq", "kegel_89_binary")
bladderhealth_mv.df %>% 
  select(listVars_tbl_summ) %>%
  tbl_summary(by = kegel_89_binary) %>%
  italicize_labels() %>%
  add_p() %>%
  bold_p()

```

Compared to women who are not doing Kegels, women doing Kegels several times a month or more are significantly older (P = 0.028), have more of a smoking history (i.e. smoked more than 100 cigarettes throughout their lifetime, P = 0.002), are less insured (P = 0.003), have a history of sexual activity (P = 0.025), have worse urinary symptoms based on LURN SI-29 scores (P = 0.020), and have higher physical activity level based on IPAQ score (P = 0.003). 

#### Univariable logistic regression 

Determine which variables are associated with women doing Kegels several times a month or more.
```{r}

univar <- bladderhealth_mv.df %>%
  select(kegel_89_binary, age, bmi, edu, race, hisp, cig_hx, insurance, health_gen, sex_hx, vag_del, lurnsi29cat, ipaq) %>%
  tbl_uvregression(
    method = glm,
    y = kegel_89_binary,
    method.args = list(family = binomial),
    exponentiate = TRUE,
    pvalue_fun = ~style_pvalue(.x, digits = 2)
  ) %>%
  add_nevent() %>%    # add number of events of the outcome
  bold_p() %>%        # bold p-values under a given threshold (default 0.05)
  bold_labels() %>%
  modify_caption("Univariable Logistic Regression")
                 
univar

```

On univariable regression, variables significantly associated with performing Kegels at least several times a month or more are older age, lifetime smoking history of 100 cigarettes or more, being uninsured, having a history of sexual activity, higher LURN SI-29 score category (i.e. more severe urinary symptoms), and higher IPAQ activity category (i.e. more physically active).
                                        
#### Multivariable logistic regression

Determine which variables are associated with women doing Kegels several times a month or more.
```{r}
  
#Drop missing values
bladderhealth_mv2.df <- bladderhealth_mv.df %>% drop_na(all_of(listVars_tbl_summ)) #1713 to 1669 observations

#Run multivariable regression
kegel89.fit <- glm(kegel_89_binary ~ age + bmi + edu + race + hisp + cig_hx + insurance + health_gen + sex_hx + vag_del + lurnsi29cat + ipaq,
                  data = bladderhealth_mv2.df, 
                  family = binomial())
summary(kegel89.fit) 


```

On multivariable regression, variables significantly associated with performing PFM exercises at least several times a month or more are high IPAQ activity category and lack of insurance coverage. 


##### Repeat regression for casus_total_cat (incontinence symptoms only) instead of lurnsi29cat (all urinary symptoms)
```{r}
kegel89.fit_casus <- glm(kegel_89_binary ~ age + bmi + edu + race + hisp + cig_hx + insurance + health_gen + sex_hx + vag_del + casus_total_cat + ipaq, 
                  data = bladderhealth_mv.df, 
                  family = binomial())
summary(kegel89.fit_casus) 
#No change in results
```
##### Convert original multivariable regression to a table
```{r}
mv <- tbl_regression(kegel89.fit,
                     exponentiate = TRUE, 
                     pvalue_fun = ~style_pvalue(.x, digits = 2)) %>%
  bold_p() %>%        # bold p-values under a given threshold (default 0.05)
  bold_labels() %>%
  modify_caption("Multivariable Logistic Regression")

#Combine multivariable and univariate analyses into a single table
univar_mv <- tbl_merge(tbls = list(univar, mv), tab_spanner = c("**Univariable**", "**Multivariable**")) %>%
   modify_caption("Logistic Regression for Performance of Pelvic Floor Muscle Exercises")
univar_mv

#Save table
univar_mv %>% as_gt() %>% gt::gtsave(filename = "PA PFM logistic regression.png")
```
#### Given the surprising finding that insured women are less likely to do PFM exercises, perform exploratory analyses.
```{r}

#Explore the relationship between insurance and other variables that significantly predicted Kegel frequency on univariate analysis (older age, lifetime smoking history of 100 cigarettes or more, being uninsured, having a history of sexual activity, higher LURN SI-29 score category, higher IPAQ activity category).

#Are uninsured women older and therefore more likely to do Kegels?
#Compare median (IQR) age between insured and uninsured.
bladderhealth_mv_insured.df <- bladderhealth_mv.df %>% filter(insurance == "Insured") 
summary(bladderhealth_mv_insured.df$age) 
#For insured, median age 43, IQR 29-59.3.
bladderhealth_mv_uninsured.df <- bladderhealth_mv.df %>% filter(insurance == "Uninsured") 
summary(bladderhealth_mv_uninsured.df$age) 
#For uninsured, median age 37, IQR 28-52.
#No, uninsured women are younger.

#Are uninsured women more likely to be  more physically active, smoke, have a history of sexual activity, or have severe urinary symptoms?
table(bladderhealth_mv.df$ipaq, bladderhealth_mv.df$insurance)
prop.table(table(bladderhealth_mv.df$ipaq, bladderhealth_mv.df$insurance), 2) 
chisq.test(bladderhealth_mv.df$ipaq, bladderhealth_mv.df$insurance, correct=FALSE)
#Uninsured women more likely to be in low activity group (55.9%, vs. 46.5% of insured women), but this difference is not significant.
table(bladderhealth_mv.df$cig_hx, bladderhealth_mv.df$insurance)
prop.table(table(bladderhealth_mv.df$cig_hx, bladderhealth_mv.df$insurance), 2) 
chisq.test(bladderhealth_mv.df$cig_hx, bladderhealth_mv.df$insurance, correct=FALSE)
#Uninsured women more likely to smoke >100 cigarettes in their lifetime (39.1%, vs. 28.8% of insured women). This difference is significant (P = 0.006474)
table(bladderhealth_mv.df$sex_hx, bladderhealth_mv.df$insurance)
prop.table(table(bladderhealth_mv.df$sex_hx, bladderhealth_mv.df$insurance), 2) 
#No obvious differences in sexual history between uninsured (3.7% never had sex) or insured (4.1% never had sex).
table(bladderhealth_mv.df$lurnsi29cat, bladderhealth_mv.df$insurance)
prop.table(table(bladderhealth_mv.df$lurnsi29cat, bladderhealth_mv.df$insurance), 2) 
chisq.test(bladderhealth_mv.df$lurnsi29cat, bladderhealth_mv.df$insurance, correct=FALSE)
#Uninsured women have more severe urinary symptoms; 38.5% in high symptom group vs. only only 31.4% for insured women). However, difference not significant.

```

Uninsured women are more likely to have lower activity levels, a smoking history of >100 cigarettes, and worse urinary symptoms. 

### Conclusions

In a cross-sectional study of community-based adult women, we found that higher physical activity level is associated with performing PFM exercises. Given that self-reported laziness was more likely to be reported as a reason for not doing PFM exercises in the low and moderate physical activity groups compared to the high activity group, interventions linking to motivational tactics and physical activity could be explored to improve PFM exercise participation. Lack of insurance could potentially be related to increased frequency of performing PFM exercises due to patients opting to do these exercises at home rather than more costly treatment options such as medication or surgery. However, those factors were not accounted for in the current dataset, so the relationship between insurance coverage and performance of PFM exercises needs to be further explored. 

Limitations of this study include the cross-sectional nature which precludes the assessment of causation, the challenges of interpreting multiple effect measures from a single logistic regression model, the possibility of unmeasured confounders, and the community-based population which may differ from the population that typically presents to clinic for bothersome symptoms and receives a formal recommendation to perform PFM exercises. Strengths of this study include the use of the IPAQ as a comprehensive assessesment of physical activity by accounting for walking and other daily activities outside of simply dedicated exercise, as well as the inclusion of women who perform PFM exercises for a variety of reasons, which provides insight into factors influencing PFM performance in a broad population. Future work could explore the temporal relationship between physical activity and PFM exercises and consider factors underlying motivation in women who could benefit from these exercises. 


### References
1. Tibaek S, Dehlendorff C. Do Women with Pelvic Floor Dysfunction Referred by Gynaecologists and Urologists at Hospitals Complete a Pelvic Floor Muscle Training Programme? A Retrospective Study, 1992-2008. Int Urogynecol J (2013) 24(8):1361-9. Epub 2013/01/08. doi: 10.1007/s00192-012-2018-2. 

2. Venegas M, Carrasco B, Casas-Cordero R. Factors Influencing Long-Term Adherence to Pelvic Floor Exercises in Women with Urinary Incontinence. Neurourol Urodyn (2018) 37(3):1120-7. Epub 2017/11/03. doi: 10.1002/nau.23432. 

3. Shannon MB, Genereux M, Brincat C, Adams W, Brubaker L, Mueller ER, et al. Attendance at Prescribed Pelvic Floor Physical Therapy in a Diverse, Urban Urogynecology Population. Pm r (2018) 10(6):601-6. Epub 2017/11/16. doi: 10.1016/j.pmrj.2017.11.008. 

4. Shannon MB, Adams W, Fitzgerald CM, Mueller ER, Brubaker L, Brincat C. Does Patient Education Augment Pelvic Floor Physical Therapy Preparedness and Attendance? A Randomized Controlled Trial. Urogynecology (2018) 24(2):155-60. doi: 10.1097/spv.0000000000000516.

5.	Jack K, McLean SM, Moffett JK, Gardiner E. Barriers to Treatment Adherence in Physiotherapy Outpatient Clinics: A Systematic Review. Man Ther (2010) 15(3):220-8. Epub 2010/02/19. doi: 10.1016/j.math.2009.12.004.

6.	Brewer BW, Cornelius AE, Van Raalte JL, Tennen H, Armeli S. Predictors of Adherence to Home Rehabilitation Exercises Following Anterior Cruciate Ligament Reconstruction. Rehabil Psychol (2013) 58(1):64-72. Epub 2013/02/27. doi: 10.1037/a0031297.
